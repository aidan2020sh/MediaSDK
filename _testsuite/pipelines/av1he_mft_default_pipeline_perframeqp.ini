pipeline MediaFoundation

define media_src     "Media Source"
define ipp_mf_fw     "Intel MF File Writer"
define mfx_mf_enc    "Intel® Hybrid AV1 Encoder MFT"

Set_Param media_src read=$(ifile)
Set_Param ipp_mf_fw write=$(ofile)

connect media_src mfx_mf_enc
connect mfx_mf_enc ipp_mf_fw

Set_Param mfx_mf_enc CODECAPI_AVEncCommonRateControlMode 3
Set_Param mfx_mf_enc CODECAPI_AVEncCommonQuality $(quality)
Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 1
Set_Param mfx_mf_enc CODECAPI_AVEncMPVGOPSize -1

resolve

Set_Param mfx_mf_enc CODECAPI_AVEncVideoEncodeQP "20 20 20 20"

Play 160

Set_Param mfx_mf_enc CODECAPI_AVEncVideoEncodeQP "30 30 30 30"

Play 160

Set_Param mfx_mf_enc CODECAPI_AVEncVideoEncodeQP "40 40 40 40"

Play 160

Set_Param mfx_mf_enc CODECAPI_AVEncVideoEncodeQP "50 50 50 50"

Play 160

Set_Param mfx_mf_enc CODECAPI_AVEncVideoEncodeQP "60 60 60 60"

Play -1

Stop
