pipeline MediaFoundation

define media_src     "Media Source"
define ipp_mf_fw     "Intel MF File Writer"
define mfx_mf_enc    "Intel® Hybrid AV1 Encoder MFT"

Set_Param media_src read=$(ifile)
Set_Param ipp_mf_fw write=$(ofile)

connect media_src mfx_mf_enc
connect mfx_mf_enc ipp_mf_fw

Set_Param mfx_mf_enc CODECAPI_AVEncCommonRateControlMode 3
Set_Param mfx_mf_enc CODECAPI_AVEncCommonQuality $(quality)
Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 1
Set_Param mfx_mf_enc CODECAPI_AVEncMPVGOPSize -1

resolve

Play 330

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 2

Play 300

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 3

Play 300

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 2

Play 300

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 1

Play 300

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 3

Play 300

Set_Param mfx_mf_enc CODECAPI_AVEncVideoTemporalLayerCount 1

Play -1

Stop
