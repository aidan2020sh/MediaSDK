// Copyright (c) 2010-2018 Intel Corporation
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.

#include "mfx_common.h"

#if defined (MFX_ENABLE_VPP) && !defined(MFX_ENABLE_HW_ONLY_VPP)

#include <math.h>

#include "mfx_vpp_utils.h"
#include "mfx_gamut_compression_vpp.h"
//-------------------------------------

//preset LUT
    static const int Vertices_BT601[512][2] =
    {

// Original table; atan2(v/u), correct information in UV zone
        {666, 1936},
        {673, 1932},
        {680, 1928},
        {687, 1924},
        {694, 1920},
        {701, 1917},
        {708, 1913},
        {715, 1910},
        {722, 1906},
        {729, 1903},
        {736, 1900},
        {743, 1897},
        {749, 1894},
        {756, 1891},
        {763, 1888},
        {770, 1885},
        {776, 1882},
        {783, 1880},
        {790, 1877},
        {796, 1875},
        {803, 1872},
        {810, 1870},
        {816, 1868},
        {823, 1866},
        {830, 1864},
        {836, 1862},
        {843, 1860},
        {849, 1858},
        {856, 1856},
        {862, 1854},
        {869, 1853},
        {875, 1851},
        {882, 1849},
        {888, 1848},
        {895, 1847},
        {901, 1845},
        {908, 1844},
        {914, 1843},
        {921, 1842},
        {927, 1841},
        {933, 1840},
        {940, 1839},
        {946, 1838},
        {953, 1838},
        {959, 1837},
        {965, 1836},
        {972, 1836},
        {978, 1835},
        {985, 1835},
        {991, 1835},
        {997, 1834},
        {1004, 1834},
        {1010, 1834},
        {1017, 1834},
        {1023, 1834},
        {1029, 1834},
        {1036, 1834},
        {1042, 1835},
        {1048, 1835},
        {1055, 1835},
        {1061, 1836},
        {1068, 1836},
        {1074, 1837},
        {1080, 1837},
        {1087, 1838},
        {1093, 1839},
        {1100, 1840},
        {1106, 1841},
        {1112, 1842},
        {1119, 1843},
        {1125, 1844},
        {1132, 1845},
        {1138, 1847},
        {1145, 1848},
        {1151, 1849},
        {1158, 1851},
        {1164, 1852},
        {1171, 1854},
        {1177, 1856},
        {1184, 1858},
        {1190, 1859},
        {1197, 1861},
        {1203, 1863},
        {1210, 1866},
        {1217, 1868},
        {1223, 1870},
        {1230, 1872},
        {1236, 1875},
        {1243, 1877},
        {1250, 1880},
        {1257, 1882},
        {1263, 1885},
        {1270, 1888},
        {1277, 1891},
        {1284, 1894},
        {1290, 1897},
        {1297, 1900},
        {1304, 1903},
        {1311, 1906},
        {1318, 1910},
        {1325, 1913},
        {1332, 1916},
        {1339, 1920},
        {1346, 1924},
        {1353, 1928},
        {1360, 1931},
        {1367, 1935},
        {1374, 1939},
        {1381, 1944},
        {1388, 1948},
        {1396, 1952},
        {1403, 1957},
        {1410, 1961},
        {1417, 1966},
        {1425, 1970},
        {1432, 1975},
        {1439, 1980},
        {1447, 1985},
        {1454, 1990},
        {1462, 1995},
        {1470, 2001},
        {1477, 2006},
        {1485, 2011},
        {1492, 2017},
        {1500, 2023},
        {1508, 2029},
        {1516, 2035},
        {1524, 2041},
        {1532, 2047},
        {1540, 2053},
        {1548, 2059},
        {1556, 2066},
        {1564, 2073},
        {1572, 2079},
        {1580, 2086},
        {1588, 2093},
        {1597, 2100},
        {1605, 2108},
        {1614, 2115},
        {1622, 2123},
        {1631, 2130},
        {1639, 2138},
        {1648, 2146},
        {1657, 2154},
        {1666, 2162},
        {1674, 2171},
        {1683, 2179},
        {1691, 2186},
        {1688, 2179},
        {1684, 2172},
        {1681, 2164},
        {1678, 2157},
        {1674, 2151},
        {1671, 2144},
        {1668, 2137},
        {1664, 2131},
        {1661, 2124},
        {1658, 2118},
        {1655, 2112},
        {1651, 2106},
        {1648, 2100},
        {1645, 2094},
        {1642, 2088},
        {1639, 2083},
        {1636, 2077},
        {1633, 2072},
        {1629, 2067},
        {1626, 2061},
        {1623, 2056},
        {1620, 2051},
        {1617, 2046},
        {1614, 2042},
        {1611, 2037},
        {1608, 2032},
        {1605, 2028},
        {1602, 2024},
        {1599, 2019},
        {1596, 2015},
        {1593, 2011},
        {1590, 2007},
        {1588, 2003},
        {1585, 1999},
        {1582, 1996},
        {1579, 1992},
        {1576, 1988},
        {1573, 1985},
        {1570, 1981},
        {1568, 1978},
        {1565, 1975},
        {1562, 1972},
        {1559, 1969},
        {1556, 1966},
        {1554, 1963},
        {1551, 1960},
        {1548, 1957},
        {1545, 1955},
        {1542, 1952},
        {1540, 1950},
        {1537, 1947},
        {1534, 1945},
        {1531, 1943},
        {1529, 1941},
        {1526, 1939},
        {1523, 1937},
        {1521, 1935},
        {1518, 1933},
        {1515, 1931},
        {1513, 1929},
        {1510, 1928},
        {1507, 1926},
        {1504, 1925},
        {1502, 1923},
        {1499, 1922},
        {1496, 1921},
        {1494, 1919},
        {1491, 1918},
        {1488, 1917},
        {1486, 1916},
        {1483, 1916},
        {1481, 1915},
        {1478, 1914},
        {1475, 1913},
        {1473, 1913},
        {1470, 1912},
        {1467, 1912},
        {1465, 1911},
        {1462, 1911},
        {1459, 1911},
        {1457, 1911},
        {1454, 1911},
        {1451, 1911},
        {1449, 1911},
        {1446, 1911},
        {1444, 1911},
        {1441, 1911},
        {1438, 1912},
        {1436, 1912},
        {1433, 1912},
        {1430, 1913},
        {1428, 1914},
        {1425, 1914},
        {1422, 1915},
        {1420, 1916},
        {1417, 1917},
        {1414, 1918},
        {1412, 1919},
        {1409, 1920},
        {1406, 1921},
        {1404, 1923},
        {1401, 1924},
        {1398, 1925},
        {1396, 1927},
        {1393, 1929},
        {1390, 1930},
        {1388, 1932},
        {1385, 1934},
        {1382, 1936},
        {1380, 1938},
        {1377, 1940},
        {1374, 1942},
        {1371, 1944},
        {1369, 1946},
        {1366, 1949},
        {1363, 1951},
        {1360, 1954},
        {1358, 1956},
        {1355, 1959},
        {1352, 1962},
        {1349, 1964},
        {1347, 1967},
        {1344, 1970},
        {1341, 1973},
        {1338, 1977},
        {1335, 1980},
        {1332, 1983},
        {1330, 1987},
        {1327, 1990},
        {1324, 1994},
        {1321, 1998},
        {1318, 2001},
        {1315, 2005},
        {1312, 2009},
        {1309, 2013},
        {1306, 2017},
        {1303, 2022},
        {1300, 2026},
        {1298, 2030},
        {1295, 2035},
        {1292, 2040},
        {1289, 2044},
        {1285, 2049},
        {1282, 2054},
        {1279, 2059},
        {1276, 2064},
        {1273, 2069},
        {1270, 2075},
        {1267, 2080},
        {1264, 2086},
        {1261, 2091},
        {1258, 2097},
        {1254, 2103},
        {1251, 2109},
        {1248, 2115},
        {1245, 2121},
        {1241, 2128},
        {1238, 2134},
        {1235, 2141},
        {1232, 2147},
        {1228, 2154},
        {1225, 2161},
        {1241, 2153},
        {1259, 2145},
        {1276, 2137},
        {1293, 2128},
        {1309, 2120},
        {1326, 2113},
        {1343, 2105},
        {1359, 2097},
        {1375, 2090},
        {1392, 2083},
        {1408, 2075},
        {1424, 2068},
        {1440, 2062},
        {1455, 2055},
        {1471, 2048},
        {1486, 2042},
        {1502, 2035},
        {1517, 2029},
        {1533, 2023},
        {1548, 2016},
        {1563, 2011},
        {1578, 2005},
        {1593, 1999},
        {1608, 1993},
        {1622, 1988},
        {1637, 1982},
        {1652, 1977},
        {1666, 1972},
        {1681, 1967},
        {1695, 1962},
        {1709, 1957},
        {1723, 1952},
        {1738, 1947},
        {1752, 1942},
        {1766, 1938},
        {1780, 1933},
        {1793, 1929},
        {1807, 1925},
        {1821, 1921},
        {1835, 1917},
        {1848, 1913},
        {1862, 1909},
        {1875, 1905},
        {1889, 1901},
        {1902, 1897},
        {1916, 1894},
        {1929, 1890},
        {1942, 1887},
        {1956, 1884},
        {1969, 1881},
        {1982, 1877},
        {1995, 1874},
        {2008, 1871},
        {2021, 1868},
        {2034, 1866},
        {2047, 1863},
        {2060, 1860},
        {2073, 1858},
        {2086, 1855},
        {2098, 1853},
        {2111, 1850},
        {2124, 1848},
        {2136, 1846},
        {2149, 1844},
        {2162, 1842},
        {2174, 1840},
        {2187, 1838},
        {2200, 1836},
        {2212, 1834},
        {2225, 1832},
        {2237, 1831},
        {2250, 1829},
        {2262, 1828},
        {2274, 1826},
        {2287, 1825},
        {2299, 1824},
        {2312, 1822},
        {2324, 1821},
        {2336, 1820},
        {2349, 1819},
        {2361, 1818},
        {2373, 1818},
        {2385, 1817},
        {2398, 1816},
        {2410, 1815},
        {2422, 1815},
        {2435, 1814},
        {2447, 1814},
        {2459, 1813},
        {2471, 1813},
        {2483, 1813},
        {2496, 1813},
        {2508, 1813},
        {2520, 1813},
        {2532, 1813},
        {2545, 1813},
        {2557, 1813},
        {2569, 1813},
        {2581, 1814},
        {2594, 1814},
        {2606, 1814},
        {2618, 1815},
        {2630, 1816},
        {2643, 1816},
        {2655, 1817},
        {2667, 1818},
        {2679, 1819},
        {2692, 1819},
        {2704, 1820},
        {2716, 1822},
        {2729, 1823},
        {2741, 1824},
        {2754, 1825},
        {2766, 1827},
        {2778, 1828},
        {2791, 1829},
        {2803, 1831},
        {2816, 1833},
        {2828, 1834},
        {2841, 1836},
        {2853, 1838},
        {2866, 1840},
        {2879, 1842},
        {2891, 1844},
        {2904, 1846},
        {2917, 1848},
        {2929, 1851},
        {2942, 1853},
        {2955, 1856},
        {2968, 1858},
        {2981, 1861},
        {2994, 1863},
        {3006, 1866},
        {3019, 1869},
        {3032, 1872},
        {3046, 1875},
        {3059, 1878},
        {3072, 1881},
        {3085, 1884},
        {3098, 1888},
        {3111, 1891},
        {3125, 1895},
        {3138, 1898},
        {3152, 1902},
        {3165, 1906},
        {3179, 1909},
        {3192, 1913},
        {3206, 1917},
        {3220, 1921},
        {3233, 1926},
        {3247, 1930},
        {3261, 1934},
        {3275, 1939},
        {3289, 1943},
        {3303, 1948},
        {3317, 1953},
        {3332, 1958},
        {3346, 1962},
        {3360, 1968},
        {3375, 1973},
        {3389, 1978},
        {3404, 1983},
        {3418, 1989},
        {3433, 1994},
        {3448, 2000},
        {3463, 2006},
        {3478, 2012},
        {3493, 2018},
        {3508, 2024},
        {3524, 2030},
        {3539, 2036},
        {3554, 2043},
        {3570, 2049},
        {3586, 2056},
        {3601, 2063},
        {3617, 2070},
        {3627, 2073},
        {3619, 2066},
        {3611, 2060},
        {3603, 2054},
        {3595, 2047},
        {3587, 2041},
        {3579, 2035},
        {3571, 2029},
        {3563, 2023},
        {3556, 2017},
        {3548, 2012},
        {3540, 2006},
        {3533, 2001},
        {3525, 1996},
        {3517, 1990},
        {3510, 1985},
        {3503, 1980},
        {3495, 1975},
        {3488, 1971},
        {3480, 1966},
        {3473, 1961},
        {3466, 1957},
        {3459, 1952},
        {3451, 1948},
        {3444, 1944},
        {3437, 1940}
    };

    static const int Vertices_BT709[512][2]=
    {

// Original table; atan2(v/u), correct information in UV zone

        {375, 2005},
        {381, 2002},
        {386, 2000},
        {391, 1997},
        {396, 1994},
        {401, 1992},
        {407, 1990},
        {412, 1987},
        {417, 1985},
        {422, 1983},
        {427, 1981},
        {432, 1979},
        {437, 1977},
        {442, 1975},
        {447, 1973},
        {453, 1972},
        {458, 1970},
        {463, 1969},
        {468, 1967},
        {473, 1966},
        {478, 1965},
        {483, 1963},
        {488, 1962},
        {493, 1961},
        {498, 1960},
        {503, 1959},
        {508, 1959},
        {513, 1958},
        {518, 1957},
        {523, 1957},
        {528, 1956},
        {533, 1956},
        {538, 1955},
        {543, 1955},
        {548, 1955},
        {553, 1954},
        {558, 1954},
        {563, 1954},
        {568, 1954},
        {572, 1955},
        {577, 1955},
        {582, 1955},
        {587, 1955},
        {592, 1956},
        {597, 1956},
        {602, 1957},
        {607, 1957},
        {612, 1958},
        {617, 1959},
        {622, 1960},
        {627, 1961},
        {632, 1962},
        {637, 1963},
        {642, 1964},
        {647, 1965},
        {652, 1967},
        {657, 1968},
        {662, 1970},
        {668, 1971},
        {673, 1973},
        {678, 1974},
        {683, 1976},
        {688, 1978},
        {693, 1980},
        {698, 1982},
        {703, 1984},
        {708, 1986},
        {713, 1989},
        {719, 1991},
        {724, 1993},
        {729, 1996},
        {734, 1998},
        {739, 2001},
        {744, 2004},
        {750, 2007},
        {755, 2010},
        {760, 2012},
        {766, 2016},
        {771, 2019},
        {776, 2022},
        {781, 2025},
        {787, 2029},
        {792, 2032},
        {798, 2036},
        {803, 2040},
        {808, 2043},
        {814, 2047},
        {819, 2051},
        {825, 2055},
        {830, 2059},
        {836, 2064},
        {841, 2068},
        {847, 2072},
        {853, 2077},
        {858, 2082},
        {864, 2086},
        {869, 2091},
        {875, 2096},
        {881, 2101},
        {887, 2106},
        {892, 2112},
        {898, 2117},
        {904, 2122},
        {910, 2128},
        {916, 2134},
        {922, 2139},
        {928, 2145},
        {934, 2151},
        {940, 2157},
        {946, 2164},
        {952, 2170},
        {958, 2177},
        {964, 2183},
        {971, 2190},
        {977, 2197},
        {983, 2204},
        {989, 2211},
        {996, 2218},
        {1002, 2225},
        {1009, 2233},
        {1015, 2241},
        {1022, 2248},
        {1028, 2256},
        {1035, 2264},
        {1042, 2272},
        {1049, 2281},
        {1055, 2289},
        {1062, 2298},
        {1069, 2307},
        {1076, 2316},
        {1083, 2325},
        {1090, 2334},
        {1097, 2344},
        {1104, 2353},
        {1112, 2363},
        {1119, 2373},
        {1126, 2383},
        {1134, 2393},
        {1141, 2404},
        {1149, 2414},
        {1156, 2425},
        {1164, 2436},
        {1165, 2433},
        {1162, 2423},
        {1160, 2412},
        {1157, 2402},
        {1154, 2393},
        {1152, 2383},
        {1149, 2374},
        {1147, 2364},
        {1145, 2355},
        {1142, 2346},
        {1140, 2337},
        {1137, 2329},
        {1135, 2320},
        {1132, 2312},
        {1130, 2304},
        {1128, 2296},
        {1125, 2288},
        {1123, 2280},
        {1121, 2272},
        {1119, 2265},
        {1116, 2257},
        {1114, 2250},
        {1112, 2243},
        {1110, 2236},
        {1107, 2229},
        {1105, 2223},
        {1103, 2216},
        {1101, 2209},
        {1099, 2203},
        {1097, 2197},
        {1095, 2191},
        {1092, 2185},
        {1090, 2179},
        {1088, 2173},
        {1086, 2167},
        {1084, 2162},
        {1082, 2156},
        {1080, 2151},
        {1078, 2146},
        {1076, 2141},
        {1074, 2136},
        {1072, 2131},
        {1070, 2126},
        {1068, 2121},
        {1066, 2117},
        {1064, 2112},
        {1062, 2108},
        {1060, 2103},
        {1058, 2099},
        {1056, 2095},
        {1054, 2091},
        {1052, 2087},
        {1050, 2083},
        {1048, 2079},
        {1046, 2076},
        {1045, 2072},
        {1043, 2069},
        {1041, 2065},
        {1039, 2062},
        {1037, 2059},
        {1035, 2056},
        {1033, 2053},
        {1031, 2050},
        {1030, 2047},
        {1028, 2044},
        {1026, 2041},
        {1024, 2039},
        {1022, 2036},
        {1020, 2034},
        {1019, 2031},
        {1017, 2029},
        {1015, 2027},
        {1013, 2025},
        {1011, 2023},
        {1009, 2021},
        {1008, 2019},
        {1006, 2017},
        {1004, 2015},
        {1002, 2014},
        {1001, 2012},
        {999, 2010},
        {997, 2009},
        {995, 2008},
        {993, 2006},
        {992, 2005},
        {990, 2004},
        {988, 2003},
        {986, 2002},
        {984, 2001},
        {983, 2000},
        {981, 2000},
        {979, 1999},
        {977, 1999},
        {976, 1998},
        {974, 1998},
        {972, 1997},
        {970, 1997},
        {969, 1997},
        {967, 1997},
        {965, 1997},
        {963, 1997},
        {962, 1997},
        {960, 1997},
        {958, 1997},
        {956, 1998},
        {955, 1998},
        {953, 1998},
        {951, 1999},
        {949, 2000},
        {947, 2000},
        {946, 2001},
        {944, 2002},
        {942, 2003},
        {940, 2004},
        {939, 2005},
        {937, 2006},
        {935, 2007},
        {933, 2009},
        {931, 2010},
        {930, 2012},
        {928, 2013},
        {926, 2015},
        {924, 2016},
        {923, 2018},
        {921, 2020},
        {919, 2022},
        {917, 2024},
        {915, 2026},
        {913, 2028},
        {912, 2031},
        {910, 2033},
        {908, 2035},
        {906, 2038},
        {904, 2041},
        {902, 2043},
        {901, 2046},
        {899, 2049},
        {897, 2052},
        {895, 2055},
        {893, 2058},
        {891, 2061},
        {889, 2064},
        {888, 2068},
        {886, 2071},
        {884, 2075},
        {882, 2078},
        {880, 2082},
        {878, 2086},
        {876, 2090},
        {874, 2094},
        {872, 2098},
        {876, 2098},
        {895, 2089},
        {914, 2080},
        {933, 2070},
        {952, 2061},
        {970, 2052},
        {989, 2044},
        {1007, 2035},
        {1025, 2027},
        {1043, 2019},
        {1061, 2010},
        {1078, 2002},
        {1096, 1995},
        {1113, 1987},
        {1130, 1979},
        {1148, 1972},
        {1164, 1964},
        {1181, 1957},
        {1198, 1950},
        {1215, 1943},
        {1231, 1936},
        {1247, 1930},
        {1264, 1923},
        {1280, 1917},
        {1296, 1910},
        {1312, 1904},
        {1328, 1898},
        {1343, 1892},
        {1359, 1886},
        {1374, 1880},
        {1390, 1875},
        {1405, 1869},
        {1420, 1863},
        {1436, 1858},
        {1451, 1853},
        {1466, 1848},
        {1481, 1843},
        {1495, 1838},
        {1510, 1833},
        {1525, 1828},
        {1539, 1823},
        {1554, 1819},
        {1568, 1814},
        {1583, 1810},
        {1597, 1805},
        {1611, 1801},
        {1625, 1797},
        {1640, 1793},
        {1654, 1789},
        {1668, 1785},
        {1681, 1781},
        {1695, 1777},
        {1709, 1774},
        {1723, 1770},
        {1737, 1767},
        {1750, 1763},
        {1764, 1760},
        {1777, 1756},
        {1791, 1753},
        {1804, 1750},
        {1818, 1747},
        {1831, 1744},
        {1844, 1741},
        {1857, 1739},
        {1871, 1736},
        {1884, 1733},
        {1897, 1731},
        {1910, 1728},
        {1923, 1726},
        {1936, 1723},
        {1949, 1721},
        {1962, 1719},
        {1975, 1717},
        {1988, 1715},
        {2001, 1713},
        {2014, 1711},
        {2026, 1709},
        {2039, 1707},
        {2052, 1705},
        {2065, 1703},
        {2077, 1702},
        {2090, 1700},
        {2103, 1699},
        {2115, 1697},
        {2128, 1696},
        {2140, 1695},
        {2153, 1694},
        {2165, 1693},
        {2178, 1691},
        {2191, 1690},
        {2203, 1689},
        {2216, 1689},
        {2228, 1688},
        {2240, 1687},
        {2253, 1686},
        {2265, 1686},
        {2278, 1685},
        {2290, 1685},
        {2303, 1684},
        {2315, 1684},
        {2327, 1684},
        {2340, 1683},
        {2352, 1683},
        {2365, 1683},
        {2377, 1683},
        {2389, 1683},
        {2402, 1683},
        {2414, 1683},
        {2427, 1683},
        {2439, 1684},
        {2451, 1684},
        {2464, 1684},
        {2476, 1685},
        {2489, 1685},
        {2501, 1686},
        {2514, 1687},
        {2526, 1687},
        {2539, 1688},
        {2551, 1689},
        {2564, 1690},
        {2576, 1691},
        {2589, 1692},
        {2601, 1693},
        {2614, 1694},
        {2626, 1695},
        {2639, 1697},
        {2651, 1698},
        {2664, 1699},
        {2677, 1701},
        {2689, 1702},
        {2702, 1704},
        {2715, 1706},
        {2728, 1708},
        {2740, 1709},
        {2753, 1711},
        {2766, 1713},
        {2779, 1715},
        {2792, 1717},
        {2805, 1720},
        {2818, 1722},
        {2831, 1724},
        {2844, 1726},
        {2857, 1729},
        {2870, 1731},
        {2883, 1734},
        {2896, 1737},
        {2909, 1740},
        {2923, 1742},
        {2936, 1745},
        {2949, 1748},
        {2963, 1751},
        {2976, 1754},
        {2990, 1758},
        {3003, 1761},
        {3017, 1764},
        {3030, 1768},
        {3044, 1771},
        {3058, 1775},
        {3072, 1779},
        {3086, 1782},
        {3100, 1786},
        {3114, 1790},
        {3128, 1794},
        {3142, 1798},
        {3156, 1802},
        {3170, 1807},
        {3184, 1811},
        {3199, 1816},
        {3213, 1820},
        {3228, 1825},
        {3243, 1830},
        {3257, 1834},
        {3272, 1839},
        {3287, 1844},
        {3302, 1849},
        {3317, 1855},
        {3332, 1860},
        {3347, 1865},
        {3362, 1871},
        {3378, 1877},
        {3393, 1882},
        {3409, 1888},
        {3424, 1894},
        {3440, 1900},
        {3456, 1906},
        {3472, 1913},
        {3488, 1919},
        {3504, 1925},
        {3520, 1932},
        {3537, 1939},
        {3553, 1946},
        {3570, 1953},
        {3587, 1960},
        {3604, 1967},
        {3621, 1974},
        {3638, 1982},
        {3655, 1990},
        {3672, 1997},
        {3690, 2005},
        {3708, 2013},
        {3725, 2021},
        {3743, 2030},
        {3761, 2038},
        {3780, 2047},
        {3798, 2056},
        {3795, 2053},
        {3790, 2049},
        {3784, 2045},
        {3779, 2041},
        {3774, 2037},
        {3768, 2034},
        {3763, 2030},
        {3758, 2027},
        {3752, 2023},
        {3747, 2020},
        {3742, 2017},
        {3736, 2014},
        {3731, 2011},
        {3726, 2008}

// Approximated table: 14 segment for luma_vertex; 15 segments for sat_vertex, both 2nd-degree polynomial
/*        {375, 2005},
        {380, 2002},
        {385, 1999},
        {391, 1997},
        {396, 1995},
        {401, 1992},
        {406, 1989},
        {412, 1987},
        {417, 1985},
        {422, 1983},
        {427, 1981},
        {432, 1979},
        {437, 1977},
        {442, 1976},
        {447, 1974},
        {453, 1972},
        {458, 1970},
        {463, 1968},
        {467, 1967},
        {473, 1966},
        {478, 1964},
        {483, 1963},
        {488, 1962},
        {492, 1960},
        {497, 1960},
        {502, 1959},
        {507, 1958},
        {511, 1957},
        {517, 1956},
        {521, 1956},
        {526, 1956},
        {531, 1955},
        {536, 1955},
        {541, 1954},
        {545, 1955},
        {550, 1954},
        {555, 1954},
        {560, 1953},
        {565, 1954},
        {570, 1953},
        {575, 1954},
        {580, 1953},
        {585, 1954},
        {590, 1954},
        {595, 1954},
        {600, 1955},
        {605, 1955},
        {610, 1956},
        {615, 1956},
        {621, 1957},
        {625, 1958},
        {631, 1959},
        {635, 1960},
        {641, 1961},
        {646, 1962},
        {651, 1963},
        {656, 1965},
        {662, 1966},
        {666, 1968},
        {672, 1970},
        {677, 1971},
        {683, 1973},
        {687, 1975},
        {693, 1977},
        {698, 1979},
        {703, 1982},
        {708, 1984},
        {713, 1987},
        {719, 1989},
        {724, 1991},
        {730, 1994},
        {735, 1996},
        {740, 2000},
        {745, 2002},
        {751, 2006},
        {756, 2008},
        {762, 2012},
        {767, 2015},
        {773, 2018},
        {778, 2022},
        {784, 2025},
        {789, 2029},
        {795, 2033},
        {800, 2037},
        {806, 2040},
        {811, 2045},
        {817, 2049},
        {822, 2052},
        {828, 2057},
        {833, 2061},
        {839, 2066},
        {844, 2070},
        {850, 2075},
        {856, 2080},
        {862, 2084},
        {867, 2089},
        {873, 2094},
        {878, 2100},
        {883, 2104},
        {890, 2110},
        {895, 2115},
        {901, 2121},
        {906, 2126},
        {912, 2131},
        {918, 2138},
        {924, 2143},
        {929, 2149},
        {936, 2155},
        {941, 2161},
        {947, 2167},
        {952, 2174},
        {959, 2180},
        {963, 2186},
        {970, 2193},
        {976, 2199},
        {982, 2206},
        {989, 2213},
        {995, 2220},
        {1001, 2227},
        {1008, 2234},
        {1015, 2241},
        {1021, 2247},
        {1028, 2256},
        {1034, 2263},
        {1041, 2272},
        {1048, 2280},
        {1055, 2289},
        {1061, 2297},
        {1069, 2306},
        {1076, 2315},
        {1082, 2324},
        {1089, 2334},
        {1097, 2343},
        {1104, 2353},
        {1111, 2363},
        {1119, 2373},
        {1126, 2383},
        {1133, 2393},
        {1141, 2404},
        {1148, 2414},
        {1155, 2425},
        {1164, 2436},
        {1162, 2433},
        {1160, 2424},
        {1158, 2413},
        {1155, 2404},
        {1153, 2394},
        {1151, 2384},
        {1148, 2375},
        {1146, 2365},
        {1143, 2357},
        {1141, 2348},
        {1139, 2339},
        {1137, 2330},
        {1135, 2321},
        {1133, 2313},
        {1130, 2305},
        {1128, 2296},
        {1126, 2289},
        {1124, 2281},
        {1122, 2273},
        {1120, 2266},
        {1118, 2258},
        {1116, 2251},
        {1113, 2244},
        {1111, 2236},
        {1109, 2230},
        {1107, 2222},
        {1104, 2216},
        {1102, 2210},
        {1100, 2203},
        {1098, 2197},
        {1096, 2190},
        {1094, 2184},
        {1092, 2179},
        {1090, 2173},
        {1088, 2167},
        {1086, 2162},
        {1084, 2156},
        {1082, 2151},
        {1079, 2146},
        {1077, 2141},
        {1075, 2136},
        {1073, 2132},
        {1071, 2126},
        {1069, 2121},
        {1067, 2117},
        {1066, 2113},
        {1063, 2108},
        {1061, 2104},
        {1059, 2100},
        {1057, 2096},
        {1055, 2091},
        {1053, 2087},
        {1051, 2083},
        {1049, 2080},
        {1047, 2076},
        {1045, 2073},
        {1043, 2069},
        {1041, 2066},
        {1039, 2063},
        {1037, 2059},
        {1035, 2056},
        {1034, 2053},
        {1032, 2050},
        {1030, 2047},
        {1028, 2044},
        {1025, 2042},
        {1023, 2039},
        {1021, 2037},
        {1019, 2034},
        {1018, 2031},
        {1016, 2029},
        {1014, 2027},
        {1012, 2025},
        {1010, 2023},
        {1008, 2021},
        {1007, 2019},
        {1005, 2017},
        {1003, 2015},
        {1001, 2014},
        {999, 2012},
        {998, 2011},
        {996, 2009},
        {994, 2008},
        {992, 2007},
        {991, 2006},
        {988, 2005},
        {986, 2004},
        {984, 2003},
        {982, 2002},
        {981, 2000},
        {979, 2000},
        {977, 1999},
        {976, 1998},
        {974, 1998},
        {972, 1998},
        {970, 1998},
        {969, 1997},
        {967, 1997},
        {965, 1997},
        {964, 1997},
        {962, 1997},
        {960, 1997},
        {959, 1997},
        {957, 1997},
        {955, 1998},
        {953, 1998},
        {951, 1999},
        {949, 1999},
        {948, 1999},
        {946, 2000},
        {944, 2001},
        {943, 2002},
        {941, 2003},
        {940, 2004},
        {938, 2005},
        {936, 2006},
        {935, 2008},
        {933, 2008},
        {932, 2010},
        {930, 2012},
        {928, 2013},
        {927, 2015},
        {925, 2016},
        {924, 2018},
        {922, 2020},
        {920, 2022},
        {919, 2024},
        {916, 2025},
        {915, 2028},
        {913, 2030},
        {911, 2033},
        {909, 2035},
        {908, 2037},
        {905, 2040},
        {903, 2042},
        {902, 2045},
        {899, 2048},
        {898, 2050},
        {896, 2053},
        {894, 2056},
        {892, 2060},
        {890, 2063},
        {888, 2065},
        {887, 2069},
        {884, 2072},
        {883, 2076},
        {880, 2079},
        {879, 2082},
        {877, 2086},
        {875, 2090},
        {872, 2094},
        {875, 2098},
        {895, 2088},
        {914, 2079},
        {932, 2070},
        {951, 2061},
        {969, 2052},
        {987, 2044},
        {1005, 2035},
        {1023, 2027},
        {1042, 2018},
        {1060, 2010},
        {1077, 2002},
        {1095, 1994},
        {1112, 1986},
        {1129, 1979},
        {1146, 1971},
        {1163, 1965},
        {1181, 1957},
        {1198, 1950},
        {1215, 1944},
        {1231, 1937},
        {1247, 1930},
        {1264, 1923},
        {1280, 1917},
        {1296, 1910},
        {1313, 1904},
        {1329, 1898},
        {1344, 1892},
        {1360, 1886},
        {1375, 1880},
        {1391, 1874},
        {1406, 1869},
        {1421, 1863},
        {1436, 1859},
        {1452, 1854},
        {1467, 1848},
        {1482, 1844},
        {1496, 1839},
        {1510, 1834},
        {1524, 1830},
        {1538, 1825},
        {1553, 1821},
        {1568, 1816},
        {1581, 1812},
        {1596, 1808},
        {1610, 1803},
        {1624, 1800},
        {1638, 1795},
        {1652, 1791},
        {1666, 1788},
        {1680, 1784},
        {1694, 1780},
        {1707, 1776},
        {1722, 1773},
        {1736, 1769},
        {1749, 1765},
        {1763, 1762},
        {1777, 1759},
        {1790, 1755},
        {1803, 1752},
        {1818, 1749},
        {1831, 1746},
        {1844, 1743},
        {1857, 1741},
        {1871, 1737},
        {1884, 1734},
        {1897, 1732},
        {1910, 1730},
        {1923, 1727},
        {1936, 1724},
        {1949, 1722},
        {1962, 1720},
        {1975, 1717},
        {1988, 1716},
        {2001, 1713},
        {2014, 1711},
        {2026, 1710},
        {2039, 1708},
        {2052, 1705},
        {2065, 1703},
        {2077, 1702},
        {2090, 1701},
        {2104, 1699},
        {2116, 1698},
        {2129, 1696},
        {2142, 1695},
        {2154, 1694},
        {2167, 1693},
        {2179, 1691},
        {2192, 1690},
        {2204, 1690},
        {2217, 1689},
        {2229, 1688},
        {2242, 1688},
        {2254, 1687},
        {2266, 1686},
        {2279, 1685},
        {2291, 1685},
        {2303, 1685},
        {2316, 1684},
        {2328, 1685},
        {2341, 1684},
        {2353, 1684},
        {2365, 1683},
        {2378, 1683},
        {2390, 1683},
        {2403, 1682},
        {2415, 1683},
        {2428, 1682},
        {2439, 1683},
        {2452, 1683},
        {2464, 1683},
        {2477, 1684},
        {2489, 1683},
        {2502, 1684},
        {2514, 1685},
        {2526, 1685},
        {2539, 1686},
        {2552, 1686},
        {2564, 1688},
        {2577, 1689},
        {2589, 1689},
        {2602, 1691},
        {2614, 1692},
        {2627, 1693},
        {2640, 1695},
        {2653, 1696},
        {2665, 1698},
        {2678, 1699},
        {2690, 1700},
        {2703, 1703},
        {2716, 1704},
        {2729, 1706},
        {2741, 1708},
        {2754, 1710},
        {2767, 1712},
        {2780, 1714},
        {2793, 1716},
        {2806, 1719},
        {2818, 1721},
        {2832, 1724},
        {2845, 1726},
        {2858, 1729},
        {2871, 1732},
        {2884, 1734},
        {2896, 1737},
        {2909, 1740},
        {2922, 1743},
        {2935, 1746},
        {2949, 1749},
        {2962, 1752},
        {2976, 1756},
        {2989, 1759},
        {3003, 1763},
        {3016, 1766},
        {3031, 1770},
        {3044, 1774},
        {3058, 1777},
        {3071, 1781},
        {3086, 1784},
        {3099, 1789},
        {3114, 1793},
        {3127, 1797},
        {3142, 1801},
        {3156, 1805},
        {3170, 1810},
        {3184, 1814},
        {3199, 1818},
        {3215, 1823},
        {3229, 1828},
        {3243, 1833},
        {3258, 1838},
        {3273, 1842},
        {3288, 1847},
        {3302, 1853},
        {3318, 1857},
        {3332, 1863},
        {3348, 1868},
        {3363, 1873},
        {3379, 1879},
        {3394, 1884},
        {3410, 1890},
        {3425, 1895},
        {3442, 1901},
        {3457, 1907},
        {3474, 1913},
        {3490, 1919},
        {3506, 1925},
        {3522, 1932},
        {3539, 1939},
        {3555, 1946},
        {3573, 1953},
        {3589, 1961},
        {3606, 1967},
        {3623, 1975},
        {3641, 1983},
        {3657, 1990},
        {3675, 1998},
        {3692, 2007},
        {3710, 2014},
        {3728, 2023},
        {3746, 2030},
        {3763, 2039},
        {3782, 2048},
        {3801, 2057},
        {3795, 2053},
        {3790, 2049},
        {3786, 2045},
        {3780, 2041},
        {3776, 2038},
        {3770, 2034},
        {3766, 2031},
        {3760, 2027},
        {3755, 2024},
        {3750, 2021},
        {3744, 2017},
        {3739, 2015},
        {3734, 2012},
        {3729, 2009} */
    };

    static const int yuv2rgb601[9] ={1024, 0, 1436, 1024, -352, -731, 1024, 1815, 0 };
    static const int yuv2rgb709[9] ={1024, 0, 1613, 1024, -192, -479, 1024, 1900, 0 };

mfxStatus CreateColorTables(int* pLumaVertexTab, int* pSatVertexTab, int* pYUV2RGBTab, bool bBT601 )
{
    mfxStatus sts = MFX_ERR_NONE;

    if (bBT601)
    {
        for ( int i =0; i< 512; ++i)
        {
            pLumaVertexTab[i] = Vertices_BT601[i][0];
            pSatVertexTab[i]  = Vertices_BT601[i][1];
        }

        for (int j = 0; j < 9 ; ++j)
        {
            pYUV2RGBTab[j] = yuv2rgb601[j];
        }
    }
    else
    {
        for ( int i =0; i< 512; ++i)
        {
            pLumaVertexTab[i] = Vertices_BT709[i][0];
            pSatVertexTab[i]  = Vertices_BT709[i][1];
        }

        for (int j = 0; j < 9 ; ++j)
        {
            pYUV2RGBTab[j] = yuv2rgb709[j];
        }
    }

    return sts;

} // mfxStatus CreateColorTables(int* pLumaVertexTab, int* pSatVertexTab, int* pYUV2RGBTab, bool bBT601 )


mfxStatus CreateDivTable(int* pTable)
{
    //Create a Div table
    const int nTableSize = 1 << GCC_DIV_TABLE_SIZE_BITS;
    const double fTableSize = nTableSize;
    const double fTablePrecUnit = 1 << GCC_DIV_TABLE_PREC_BITS;
    const int nMaxVal = (1 << GCC_DIV_TABLE_PREC_BITS) - 1;

    for(int i=0; i<nTableSize; ++i)
    {
        pTable[i] = (int)(0.5 + (fTablePrecUnit * fTableSize / (fTableSize + (double)i)));

        if(pTable[i] > nMaxVal)
        {
            pTable[i] = nMaxVal;
        }
    }

    return MFX_ERR_NONE;

} // mfxStatus CreateDivTable(int* pTable)

//-------------------------------------
#endif // MFX_ENABLE_VPP
/* EOF */
