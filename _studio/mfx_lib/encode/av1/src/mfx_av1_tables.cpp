// Copyright (c) 2014-2019 Intel Corporation
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.


#include "mfx_common.h"

#if defined (MFX_ENABLE_AV1_VIDEO_ENCODE)

#include "mfxdefs.h"
#include "mfx_av1_defs.h"
#include "mfx_av1_tables.h"

namespace AV1Enc {

    const uint8_t qindexMinus1[256] = {
          1,
          1,  2,  3,  4,  5,  5,  6,  8,  9, 10, 11, 12, 12, 12, 13, 14, //16
         16, 17, 18, 19, 20, 20, 21, 21, 22, 24, 25, 26, 26, 27, 28, 29, //32
         31, 31, 32, 32, 33, 34, 35, 36, 38, 38, 39, 40, 40, 41, 42, 42, //48
         44, 45, 46, 47, 48, 48, 50, 50, 51, 52, 52, 53, 54, 56, 57, 58, //64
         58, 59, 61, 61, 62, 62, 63, 64, 65, 67, 67, 68, 69, 70, 70, 70, //80
         72, 73, 74, 75, 75, 77, 78, 79, 79, 80, 80, 82, 83, 83, 85, 87, //96
         89, 91, 92, 94, 96, 97, 98, 98, 99,100,101,102,103,103,104,105, //112
        106,107,108,109,109,110,111,113,114,115,116,118,120,120,121,122, //128
        123,124,125,125,126,127,128,129,130,132,132,134,135,136,137,138,
        139,140,141,142,142,143,145,145,147,148,149,150,151,152,152,153,
        154,155,157,157,158,160,160,161,162,163,164,165,166,167,168,170,
        170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,
        186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,
        202,203,204,205,207,208,209,210,211,212,213,214,215,217,218,219,
        220,221,222,223,224,226,227,228,229,230,231,233,234,235,236,237,
        238,239,241,242,243,244,245,246,247,248,249,250,252,253,254,
    };

    const uint8_t qindexPlus1[256] = {
          1,  2,  3,  4,  5,  7,  8,  8,  9, 10, 11, 12, 15, 16, 17, 17, //15
         18, 19, 20, 21, 23, 25, 26, 26, 27, 28, 30, 31, 32, 33, 33, 35, //31
         37, 38, 39, 40, 41, 41, 43, 44, 46, 47, 49, 49, 50, 51, 52, 53, //47
         55, 55, 57, 58, 60, 61, 62, 62, 63, 64, 66, 67, 67, 69, 71, 72, //63
         73, 74, 74, 76, 77, 78, 81, 81, 82, 83, 84, 86, 86, 87, 88, 90, //79
         92, 92, 93, 95, 95, 96, 96, 97, 97, 98, 98, 99,100,100,101,101, //95
        102,103,105,106,107,108,109,111,112,113,114,115,116,118,119,120, //111
        120,121,122,123,124,124,125,125,127,128,129,130,131,133,134,135, //127
        136,137,138,138,140,140,141,142,143,144,145,146,147,148,150,151, //143
        151,153,153,154,155,156,157,158,160,161,162,163,163,165,166,166, //159
        168,169,170,171,172,173,174,175,176,176,178,179,180,181,182,183, //175
        184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199, //191
        200,201,202,203,204,205,206,207,208,209,210,211,212,213,213,214,
        215,216,217,218,219,220,221,222,222,223,224,225,226,227,228,229,
        230,230,231,232,233,234,235,236,236,237,238,239,240,241,242,243,
        243,244,245,246,247,248,249,250,251,252,253,253,254,255,255,255
    };

    const int8_t h265_log2m2[257] = {
        -1,  -1,  -1,  -1,   0,  -1,  -1,  -1,   1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        2,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        3,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        4,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        5,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
        6,
    };


    const uint8_t av1_scan_z2r4[256] =
    {
        0,   1,  16,  17,   2,   3,  18,  19,  32,  33,  48,  49,  34,  35,  50,  51,
        4,   5,  20,  21,   6,   7,  22,  23,  36,  37,  52,  53,  38,  39,  54,  55,
        64,  65,  80,  81,  66,  67,  82,  83,  96,  97, 112, 113,  98,  99, 114, 115,
        68,  69,  84,  85,  70,  71,  86,  87, 100, 101, 116, 117, 102, 103, 118, 119,
        8,   9,  24,  25,  10,  11,  26,  27,  40,  41,  56,  57,  42,  43,  58,  59,
        12,  13,  28,  29,  14,  15,  30,  31,  44,  45,  60,  61,  46,  47,  62,  63,
        72,  73,  88,  89,  74,  75,  90,  91, 104, 105, 120, 121, 106, 107, 122, 123,
        76,  77,  92,  93,  78,  79,  94,  95, 108, 109, 124, 125, 110, 111, 126, 127,
        128, 129, 144, 145, 130, 131, 146, 147, 160, 161, 176, 177, 162, 163, 178, 179,
        132, 133, 148, 149, 134, 135, 150, 151, 164, 165, 180, 181, 166, 167, 182, 183,
        192, 193, 208, 209, 194, 195, 210, 211, 224, 225, 240, 241, 226, 227, 242, 243,
        196, 197, 212, 213, 198, 199, 214, 215, 228, 229, 244, 245, 230, 231, 246, 247,
        136, 137, 152, 153, 138, 139, 154, 155, 168, 169, 184, 185, 170, 171, 186, 187,
        140, 141, 156, 157, 142, 143, 158, 159, 172, 173, 188, 189, 174, 175, 190, 191,
        200, 201, 216, 217, 202, 203, 218, 219, 232, 233, 248, 249, 234, 235, 250, 251,
        204, 205, 220, 221, 206, 207, 222, 223, 236, 237, 252, 253, 238, 239, 254, 255
    };

    const uint8_t h265_scan_r2z4[256] =
    {
        0,   1,   4,   5,  16,  17,  20,  21,  64,  65,  68,  69,  80,  81,  84,  85,
        2,   3,   6,   7,  18,  19,  22,  23,  66,  67,  70,  71,  82,  83,  86,  87,
        8,   9,  12,  13,  24,  25,  28,  29,  72,  73,  76,  77,  88,  89,  92,  93,
        10,  11,  14,  15,  26,  27,  30,  31,  74,  75,  78,  79,  90,  91,  94,  95,
        32,  33,  36,  37,  48,  49,  52,  53,  96,  97, 100, 101, 112, 113, 116, 117,
        34,  35,  38,  39,  50,  51,  54,  55,  98,  99, 102, 103, 114, 115, 118, 119,
        40,  41,  44,  45,  56,  57,  60,  61, 104, 105, 108, 109, 120, 121, 124, 125,
        42,  43,  46,  47,  58,  59,  62,  63, 106, 107, 110, 111, 122, 123, 126, 127,
        128, 129, 132, 133, 144, 145, 148, 149, 192, 193, 196, 197, 208, 209, 212, 213,
        130, 131, 134, 135, 146, 147, 150, 151, 194, 195, 198, 199, 210, 211, 214, 215,
        136, 137, 140, 141, 152, 153, 156, 157, 200, 201, 204, 205, 216, 217, 220, 221,
        138, 139, 142, 143, 154, 155, 158, 159, 202, 203, 206, 207, 218, 219, 222, 223,
        160, 161, 164, 165, 176, 177, 180, 181, 224, 225, 228, 229, 240, 241, 244, 245,
        162, 163, 166, 167, 178, 179, 182, 183, 226, 227, 230, 231, 242, 243, 246, 247,
        168, 169, 172, 173, 184, 185, 188, 189, 232, 233, 236, 237, 248, 249, 252, 253,
        170, 171, 174, 175, 186, 187, 190, 191, 234, 235, 238, 239, 250, 251, 254, 255
    };

    const uint8_t h265_scan_left[256] = {
        85,   0,  87,   2,   1,   4,   3,   6,  93,   8,  95,  10,   9,  12,  11,  14,
        5,  16,   7,  18,  17,  20,  19,  22,  13,  24,  15,  26,  25,  28,  27,  30,
        117,  32, 119,  34,  33,  36,  35,  38, 125,  40, 127,  42,  41,  44,  43,  46,
        37,  48,  39,  50,  49,  52,  51,  54,  45,  56,  47,  58,  57,  60,  59,  62,
        21,  64,  23,  66,  65,  68,  67,  70,  29,  72,  31,  74,  73,  76,  75,  78,
        69,  80,  71,  82,  81,  84,  83,  86,  77,  88,  79,  90,  89,  92,  91,  94,
        53,  96,  55,  98,  97, 100,  99, 102,  61, 104,  63, 106, 105, 108, 107, 110,
        101, 112, 103, 114, 113, 116, 115, 118, 109, 120, 111, 122, 121, 124, 123, 126,
        213, 128, 215, 130, 129, 132, 131, 134, 221, 136, 223, 138, 137, 140, 139, 142,
        133, 144, 135, 146, 145, 148, 147, 150, 141, 152, 143, 154, 153, 156, 155, 158,
        245, 160, 247, 162, 161, 164, 163, 166, 253, 168, 255, 170, 169, 172, 171, 174,
        165, 176, 167, 178, 177, 180, 179, 182, 173, 184, 175, 186, 185, 188, 187, 190,
        149, 192, 151, 194, 193, 196, 195, 198, 157, 200, 159, 202, 201, 204, 203, 206,
        197, 208, 199, 210, 209, 212, 211, 214, 205, 216, 207, 218, 217, 220, 219, 222,
        181, 224, 183, 226, 225, 228, 227, 230, 189, 232, 191, 234, 233, 236, 235, 238,
        229, 240, 231, 242, 241, 244, 243, 246, 237, 248, 239, 250, 249, 252, 251, 254,
    };

    const uint8_t h265_scan_above[256] = {
        170, 171,   0,   1, 174, 175,   4,   5,   2,   3,   8,   9,   6,   7,  12,  13,
        186, 187,  16,  17, 190, 191,  20,  21,  18,  19,  24,  25,  22,  23,  28,  29,
        10,  11,  32,  33,  14,  15,  36,  37,  34,  35,  40,  41,  38,  39,  44,  45,
        26,  27,  48,  49,  30,  31,  52,  53,  50,  51,  56,  57,  54,  55,  60,  61,
        234, 235,  64,  65, 238, 239,  68,  69,  66,  67,  72,  73,  70,  71,  76,  77,
        250, 251,  80,  81, 254, 255,  84,  85,  82,  83,  88,  89,  86,  87,  92,  93,
        74,  75,  96,  97,  78,  79, 100, 101,  98,  99, 104, 105, 102, 103, 108, 109,
        90,  91, 112, 113,  94,  95, 116, 117, 114, 115, 120, 121, 118, 119, 124, 125,
        42,  43, 128, 129,  46,  47, 132, 133, 130, 131, 136, 137, 134, 135, 140, 141,
        58,  59, 144, 145,  62,  63, 148, 149, 146, 147, 152, 153, 150, 151, 156, 157,
        138, 139, 160, 161, 142, 143, 164, 165, 162, 163, 168, 169, 166, 167, 172, 173,
        154, 155, 176, 177, 158, 159, 180, 181, 178, 179, 184, 185, 182, 183, 188, 189,
        106, 107, 192, 193, 110, 111, 196, 197, 194, 195, 200, 201, 198, 199, 204, 205,
        122, 123, 208, 209, 126, 127, 212, 213, 210, 211, 216, 217, 214, 215, 220, 221,
        202, 203, 224, 225, 206, 207, 228, 229, 226, 227, 232, 233, 230, 231, 236, 237,
        218, 219, 240, 241, 222, 223, 244, 245, 242, 243, 248, 249, 246, 247, 252, 253,
    };

    const uint8_t h265_pgop_layers[PGOP_PIC_SIZE] =
    {
        0, 2, 1, 2
    };

    const float h265_reci_1to116[16] = { 1.f,   1.f/2,  1.f/3,  1.f/4,  1.f/5,  1.f/6,  1.f/7,  1.f/8,
        1.f/9, 1.f/10, 1.f/11, 1.f/12, 1.f/13, 1.f/14, 1.f/15, 1.f/16 };

    namespace {
        enum {
            C = 0,  // current SB
            L = 1,  // left SB
            A = 2,  // above SB
            D = 3   // above-left SB
        };
    }

    const MvRefLoc mv_ref_locations_4x4[256][8] = {
        { {A,168}, {L, 84}, {D,252}, {A,160}, {L, 80}, {D,244}, {D,248}, {D,240}, }, // zidx = 0
        { {A,169}, {L, 85}, {D,253}, {A,161}, {L, 81}, {D,245}, {D,249}, {D,241}, }, // zidx = 1
        { {A,170}, {L, 86}, {D,254}, {A,162}, {L, 82}, {D,246}, {D,250}, {D,242}, }, // zidx = 2
        { {A,171}, {L, 87}, {D,255}, {A,163}, {L, 83}, {D,247}, {D,251}, {D,243}, }, // zidx = 3
        { {A,172}, {C,  0}, {A,168}, {A,164}, {L, 84}, {A,160}, {D,252}, {D,244}, }, // zidx = 4
        { {A,173}, {C,  1}, {A,169}, {A,165}, {L, 85}, {A,161}, {D,253}, {D,245}, }, // zidx = 5
        { {A,174}, {C,  2}, {A,170}, {A,166}, {L, 86}, {A,162}, {D,254}, {D,246}, }, // zidx = 6
        { {A,175}, {C,  3}, {A,171}, {A,167}, {L, 87}, {A,163}, {D,255}, {D,247}, }, // zidx = 7
        { {C,  0}, {L, 92}, {L, 84}, {A,168}, {L, 88}, {D,252}, {L, 80}, {D,248}, }, // zidx = 8
        { {C,  1}, {L, 93}, {L, 85}, {A,169}, {L, 89}, {D,253}, {L, 81}, {D,249}, }, // zidx = 9
        { {C,  2}, {L, 94}, {L, 86}, {A,170}, {L, 90}, {D,254}, {L, 82}, {D,250}, }, // zidx = 10
        { {C,  3}, {L, 95}, {L, 87}, {A,171}, {L, 91}, {D,255}, {L, 83}, {D,251}, }, // zidx = 11
        { {C,  4}, {C,  8}, {C,  0}, {A,172}, {L, 92}, {A,168}, {L, 84}, {D,252}, }, // zidx = 12
        { {C,  5}, {C,  9}, {C,  1}, {A,173}, {L, 93}, {A,169}, {L, 85}, {D,253}, }, // zidx = 13
        { {C,  6}, {C, 10}, {C,  2}, {A,174}, {L, 94}, {A,170}, {L, 86}, {D,254}, }, // zidx = 14
        { {C,  7}, {C, 11}, {C,  3}, {A,175}, {L, 95}, {A,171}, {L, 87}, {D,255}, }, // zidx = 15
        { {A,184}, {C,  4}, {A,172}, {A,176}, {C,  0}, {A,164}, {A,168}, {A,160}, }, // zidx = 16
        { {A,185}, {C,  5}, {A,173}, {A,177}, {C,  1}, {A,165}, {A,169}, {A,161}, }, // zidx = 17
        { {A,186}, {C,  6}, {A,174}, {A,178}, {C,  2}, {A,166}, {A,170}, {A,162}, }, // zidx = 18
        { {A,187}, {C,  7}, {A,175}, {A,179}, {C,  3}, {A,167}, {A,171}, {A,163}, }, // zidx = 19
        { {A,188}, {C, 16}, {A,184}, {A,180}, {C,  4}, {A,176}, {A,172}, {A,164}, }, // zidx = 20
        { {A,189}, {C, 17}, {A,185}, {A,181}, {C,  5}, {A,177}, {A,173}, {A,165}, }, // zidx = 21
        { {A,190}, {C, 18}, {A,186}, {A,182}, {C,  6}, {A,178}, {A,174}, {A,166}, }, // zidx = 22
        { {A,191}, {C, 19}, {A,187}, {A,183}, {C,  7}, {A,179}, {A,175}, {A,167}, }, // zidx = 23
        { {C, 16}, {C, 12}, {C,  4}, {A,184}, {C,  8}, {A,172}, {C,  0}, {A,168}, }, // zidx = 24
        { {C, 17}, {C, 13}, {C,  5}, {A,185}, {C,  9}, {A,173}, {C,  1}, {A,169}, }, // zidx = 25
        { {C, 18}, {C, 14}, {C,  6}, {A,186}, {C, 10}, {A,174}, {C,  2}, {A,170}, }, // zidx = 26
        { {C, 19}, {C, 15}, {C,  7}, {A,187}, {C, 11}, {A,175}, {C,  3}, {A,171}, }, // zidx = 27
        { {C, 20}, {C, 24}, {C, 16}, {A,188}, {C, 12}, {A,184}, {C,  4}, {A,172}, }, // zidx = 28
        { {C, 21}, {C, 25}, {C, 17}, {A,189}, {C, 13}, {A,185}, {C,  5}, {A,173}, }, // zidx = 29
        { {C, 22}, {C, 26}, {C, 18}, {A,190}, {C, 14}, {A,186}, {C,  6}, {A,174}, }, // zidx = 30
        { {C, 23}, {C, 27}, {C, 19}, {A,191}, {C, 15}, {A,187}, {C,  7}, {A,175}, }, // zidx = 31
        { {C,  8}, {L,116}, {L, 92}, {C,  0}, {L,112}, {L, 84}, {L, 88}, {L, 80}, }, // zidx = 32
        { {C,  9}, {L,117}, {L, 93}, {C,  1}, {L,113}, {L, 85}, {L, 89}, {L, 81}, }, // zidx = 33
        { {C, 10}, {L,118}, {L, 94}, {C,  2}, {L,114}, {L, 86}, {L, 90}, {L, 82}, }, // zidx = 34
        { {C, 11}, {L,119}, {L, 95}, {C,  3}, {L,115}, {L, 87}, {L, 91}, {L, 83}, }, // zidx = 35
        { {C, 12}, {C, 32}, {C,  8}, {C,  4}, {L,116}, {C,  0}, {L, 92}, {L, 84}, }, // zidx = 36
        { {C, 13}, {C, 33}, {C,  9}, {C,  5}, {L,117}, {C,  1}, {L, 93}, {L, 85}, }, // zidx = 37
        { {C, 14}, {C, 34}, {C, 10}, {C,  6}, {L,118}, {C,  2}, {L, 94}, {L, 86}, }, // zidx = 38
        { {C, 15}, {C, 35}, {C, 11}, {C,  7}, {L,119}, {C,  3}, {L, 95}, {L, 87}, }, // zidx = 39
        { {C, 32}, {L,124}, {L,116}, {C,  8}, {L,120}, {L, 92}, {L,112}, {L, 88}, }, // zidx = 40
        { {C, 33}, {L,125}, {L,117}, {C,  9}, {L,121}, {L, 93}, {L,113}, {L, 89}, }, // zidx = 41
        { {C, 34}, {L,126}, {L,118}, {C, 10}, {L,122}, {L, 94}, {L,114}, {L, 90}, }, // zidx = 42
        { {C, 35}, {L,127}, {L,119}, {C, 11}, {L,123}, {L, 95}, {L,115}, {L, 91}, }, // zidx = 43
        { {C, 36}, {C, 40}, {C, 32}, {C, 12}, {L,124}, {C,  8}, {L,116}, {L, 92}, }, // zidx = 44
        { {C, 37}, {C, 41}, {C, 33}, {C, 13}, {L,125}, {C,  9}, {L,117}, {L, 93}, }, // zidx = 45
        { {C, 38}, {C, 42}, {C, 34}, {C, 14}, {L,126}, {C, 10}, {L,118}, {L, 94}, }, // zidx = 46
        { {C, 39}, {C, 43}, {C, 35}, {C, 15}, {L,127}, {C, 11}, {L,119}, {L, 95}, }, // zidx = 47
        { {C, 24}, {C, 36}, {C, 12}, {C, 16}, {C, 32}, {C,  4}, {C,  8}, {C,  0}, }, // zidx = 48
        { {C, 25}, {C, 37}, {C, 13}, {C, 17}, {C, 33}, {C,  5}, {C,  9}, {C,  1}, }, // zidx = 49
        { {C, 26}, {C, 38}, {C, 14}, {C, 18}, {C, 34}, {C,  6}, {C, 10}, {C,  2}, }, // zidx = 50
        { {C, 27}, {C, 39}, {C, 15}, {C, 19}, {C, 35}, {C,  7}, {C, 11}, {C,  3}, }, // zidx = 51
        { {C, 28}, {C, 48}, {C, 24}, {C, 20}, {C, 36}, {C, 16}, {C, 12}, {C,  4}, }, // zidx = 52
        { {C, 29}, {C, 49}, {C, 25}, {C, 21}, {C, 37}, {C, 17}, {C, 13}, {C,  5}, }, // zidx = 53
        { {C, 30}, {C, 50}, {C, 26}, {C, 22}, {C, 38}, {C, 18}, {C, 14}, {C,  6}, }, // zidx = 54
        { {C, 31}, {C, 51}, {C, 27}, {C, 23}, {C, 39}, {C, 19}, {C, 15}, {C,  7}, }, // zidx = 55
        { {C, 48}, {C, 44}, {C, 36}, {C, 24}, {C, 40}, {C, 12}, {C, 32}, {C,  8}, }, // zidx = 56
        { {C, 49}, {C, 45}, {C, 37}, {C, 25}, {C, 41}, {C, 13}, {C, 33}, {C,  9}, }, // zidx = 57
        { {C, 50}, {C, 46}, {C, 38}, {C, 26}, {C, 42}, {C, 14}, {C, 34}, {C, 10}, }, // zidx = 58
        { {C, 51}, {C, 47}, {C, 39}, {C, 27}, {C, 43}, {C, 15}, {C, 35}, {C, 11}, }, // zidx = 59
        { {C, 52}, {C, 56}, {C, 48}, {C, 28}, {C, 44}, {C, 24}, {C, 36}, {C, 12}, }, // zidx = 60
        { {C, 53}, {C, 57}, {C, 49}, {C, 29}, {C, 45}, {C, 25}, {C, 37}, {C, 13}, }, // zidx = 61
        { {C, 54}, {C, 58}, {C, 50}, {C, 30}, {C, 46}, {C, 26}, {C, 38}, {C, 14}, }, // zidx = 62
        { {C, 55}, {C, 59}, {C, 51}, {C, 31}, {C, 47}, {C, 27}, {C, 39}, {C, 15}, }, // zidx = 63
        { {A,232}, {C, 20}, {A,188}, {A,224}, {C, 16}, {A,180}, {A,184}, {A,176}, }, // zidx = 64
        { {A,233}, {C, 21}, {A,189}, {A,225}, {C, 17}, {A,181}, {A,185}, {A,177}, }, // zidx = 65
        { {A,234}, {C, 22}, {A,190}, {A,226}, {C, 18}, {A,182}, {A,186}, {A,178}, }, // zidx = 66
        { {A,235}, {C, 23}, {A,191}, {A,227}, {C, 19}, {A,183}, {A,187}, {A,179}, }, // zidx = 67
        { {A,236}, {C, 64}, {A,232}, {A,228}, {C, 20}, {A,224}, {A,188}, {A,180}, }, // zidx = 68
        { {A,237}, {C, 65}, {A,233}, {A,229}, {C, 21}, {A,225}, {A,189}, {A,181}, }, // zidx = 69
        { {A,238}, {C, 66}, {A,234}, {A,230}, {C, 22}, {A,226}, {A,190}, {A,182}, }, // zidx = 70
        { {A,239}, {C, 67}, {A,235}, {A,231}, {C, 23}, {A,227}, {A,191}, {A,183}, }, // zidx = 71
        { {C, 64}, {C, 28}, {C, 20}, {A,232}, {C, 24}, {A,188}, {C, 16}, {A,184}, }, // zidx = 72
        { {C, 65}, {C, 29}, {C, 21}, {A,233}, {C, 25}, {A,189}, {C, 17}, {A,185}, }, // zidx = 73
        { {C, 66}, {C, 30}, {C, 22}, {A,234}, {C, 26}, {A,190}, {C, 18}, {A,186}, }, // zidx = 74
        { {C, 67}, {C, 31}, {C, 23}, {A,235}, {C, 27}, {A,191}, {C, 19}, {A,187}, }, // zidx = 75
        { {C, 68}, {C, 72}, {C, 64}, {A,236}, {C, 28}, {A,232}, {C, 20}, {A,188}, }, // zidx = 76
        { {C, 69}, {C, 73}, {C, 65}, {A,237}, {C, 29}, {A,233}, {C, 21}, {A,189}, }, // zidx = 77
        { {C, 70}, {C, 74}, {C, 66}, {A,238}, {C, 30}, {A,234}, {C, 22}, {A,190}, }, // zidx = 78
        { {C, 71}, {C, 75}, {C, 67}, {A,239}, {C, 31}, {A,235}, {C, 23}, {A,191}, }, // zidx = 79
        { {A,248}, {C, 68}, {A,236}, {A,240}, {C, 64}, {A,228}, {A,232}, {A,224}, }, // zidx = 80
        { {A,249}, {C, 69}, {A,237}, {A,241}, {C, 65}, {A,229}, {A,233}, {A,225}, }, // zidx = 81
        { {A,250}, {C, 70}, {A,238}, {A,242}, {C, 66}, {A,230}, {A,234}, {A,226}, }, // zidx = 82
        { {A,251}, {C, 71}, {A,239}, {A,243}, {C, 67}, {A,231}, {A,235}, {A,227}, }, // zidx = 83
        { {A,252}, {C, 80}, {A,248}, {A,244}, {C, 68}, {A,240}, {A,236}, {A,228}, }, // zidx = 84
        { {A,253}, {C, 81}, {A,249}, {A,245}, {C, 69}, {A,241}, {A,237}, {A,229}, }, // zidx = 85
        { {A,254}, {C, 82}, {A,250}, {A,246}, {C, 70}, {A,242}, {A,238}, {A,230}, }, // zidx = 86
        { {A,255}, {C, 83}, {A,251}, {A,247}, {C, 71}, {A,243}, {A,239}, {A,231}, }, // zidx = 87
        { {C, 80}, {C, 76}, {C, 68}, {A,248}, {C, 72}, {A,236}, {C, 64}, {A,232}, }, // zidx = 88
        { {C, 81}, {C, 77}, {C, 69}, {A,249}, {C, 73}, {A,237}, {C, 65}, {A,233}, }, // zidx = 89
        { {C, 82}, {C, 78}, {C, 70}, {A,250}, {C, 74}, {A,238}, {C, 66}, {A,234}, }, // zidx = 90
        { {C, 83}, {C, 79}, {C, 71}, {A,251}, {C, 75}, {A,239}, {C, 67}, {A,235}, }, // zidx = 91
        { {C, 84}, {C, 88}, {C, 80}, {A,252}, {C, 76}, {A,248}, {C, 68}, {A,236}, }, // zidx = 92
        { {C, 85}, {C, 89}, {C, 81}, {A,253}, {C, 77}, {A,249}, {C, 69}, {A,237}, }, // zidx = 93
        { {C, 86}, {C, 90}, {C, 82}, {A,254}, {C, 78}, {A,250}, {C, 70}, {A,238}, }, // zidx = 94
        { {C, 87}, {C, 91}, {C, 83}, {A,255}, {C, 79}, {A,251}, {C, 71}, {A,239}, }, // zidx = 95
        { {C, 72}, {C, 52}, {C, 28}, {C, 64}, {C, 48}, {C, 20}, {C, 24}, {C, 16}, }, // zidx = 96
        { {C, 73}, {C, 53}, {C, 29}, {C, 65}, {C, 49}, {C, 21}, {C, 25}, {C, 17}, }, // zidx = 97
        { {C, 74}, {C, 54}, {C, 30}, {C, 66}, {C, 50}, {C, 22}, {C, 26}, {C, 18}, }, // zidx = 98
        { {C, 75}, {C, 55}, {C, 31}, {C, 67}, {C, 51}, {C, 23}, {C, 27}, {C, 19}, }, // zidx = 99
        { {C, 76}, {C, 96}, {C, 72}, {C, 68}, {C, 52}, {C, 64}, {C, 28}, {C, 20}, }, // zidx = 100
        { {C, 77}, {C, 97}, {C, 73}, {C, 69}, {C, 53}, {C, 65}, {C, 29}, {C, 21}, }, // zidx = 101
        { {C, 78}, {C, 98}, {C, 74}, {C, 70}, {C, 54}, {C, 66}, {C, 30}, {C, 22}, }, // zidx = 102
        { {C, 79}, {C, 99}, {C, 75}, {C, 71}, {C, 55}, {C, 67}, {C, 31}, {C, 23}, }, // zidx = 103
        { {C, 96}, {C, 60}, {C, 52}, {C, 72}, {C, 56}, {C, 28}, {C, 48}, {C, 24}, }, // zidx = 104
        { {C, 97}, {C, 61}, {C, 53}, {C, 73}, {C, 57}, {C, 29}, {C, 49}, {C, 25}, }, // zidx = 105
        { {C, 98}, {C, 62}, {C, 54}, {C, 74}, {C, 58}, {C, 30}, {C, 50}, {C, 26}, }, // zidx = 106
        { {C, 99}, {C, 63}, {C, 55}, {C, 75}, {C, 59}, {C, 31}, {C, 51}, {C, 27}, }, // zidx = 107
        { {C,100}, {C,104}, {C, 96}, {C, 76}, {C, 60}, {C, 72}, {C, 52}, {C, 28}, }, // zidx = 108
        { {C,101}, {C,105}, {C, 97}, {C, 77}, {C, 61}, {C, 73}, {C, 53}, {C, 29}, }, // zidx = 109
        { {C,102}, {C,106}, {C, 98}, {C, 78}, {C, 62}, {C, 74}, {C, 54}, {C, 30}, }, // zidx = 110
        { {C,103}, {C,107}, {C, 99}, {C, 79}, {C, 63}, {C, 75}, {C, 55}, {C, 31}, }, // zidx = 111
        { {C, 88}, {C,100}, {C, 76}, {C, 80}, {C, 96}, {C, 68}, {C, 72}, {C, 64}, }, // zidx = 112
        { {C, 89}, {C,101}, {C, 77}, {C, 81}, {C, 97}, {C, 69}, {C, 73}, {C, 65}, }, // zidx = 113
        { {C, 90}, {C,102}, {C, 78}, {C, 82}, {C, 98}, {C, 70}, {C, 74}, {C, 66}, }, // zidx = 114
        { {C, 91}, {C,103}, {C, 79}, {C, 83}, {C, 99}, {C, 71}, {C, 75}, {C, 67}, }, // zidx = 115
        { {C, 92}, {C,112}, {C, 88}, {C, 84}, {C,100}, {C, 80}, {C, 76}, {C, 68}, }, // zidx = 116
        { {C, 93}, {C,113}, {C, 89}, {C, 85}, {C,101}, {C, 81}, {C, 77}, {C, 69}, }, // zidx = 117
        { {C, 94}, {C,114}, {C, 90}, {C, 86}, {C,102}, {C, 82}, {C, 78}, {C, 70}, }, // zidx = 118
        { {C, 95}, {C,115}, {C, 91}, {C, 87}, {C,103}, {C, 83}, {C, 79}, {C, 71}, }, // zidx = 119
        { {C,112}, {C,108}, {C,100}, {C, 88}, {C,104}, {C, 76}, {C, 96}, {C, 72}, }, // zidx = 120
        { {C,113}, {C,109}, {C,101}, {C, 89}, {C,105}, {C, 77}, {C, 97}, {C, 73}, }, // zidx = 121
        { {C,114}, {C,110}, {C,102}, {C, 90}, {C,106}, {C, 78}, {C, 98}, {C, 74}, }, // zidx = 122
        { {C,115}, {C,111}, {C,103}, {C, 91}, {C,107}, {C, 79}, {C, 99}, {C, 75}, }, // zidx = 123
        { {C,116}, {C,120}, {C,112}, {C, 92}, {C,108}, {C, 88}, {C,100}, {C, 76}, }, // zidx = 124
        { {C,117}, {C,121}, {C,113}, {C, 93}, {C,109}, {C, 89}, {C,101}, {C, 77}, }, // zidx = 125
        { {C,118}, {C,122}, {C,114}, {C, 94}, {C,110}, {C, 90}, {C,102}, {C, 78}, }, // zidx = 126
        { {C,119}, {C,123}, {C,115}, {C, 95}, {C,111}, {C, 91}, {C,103}, {C, 79}, }, // zidx = 127
        { {C, 40}, {L,212}, {L,124}, {C, 32}, {L,208}, {L,116}, {L,120}, {L,112}, }, // zidx = 128
        { {C, 41}, {L,213}, {L,125}, {C, 33}, {L,209}, {L,117}, {L,121}, {L,113}, }, // zidx = 129
        { {C, 42}, {L,214}, {L,126}, {C, 34}, {L,210}, {L,118}, {L,122}, {L,114}, }, // zidx = 130
        { {C, 43}, {L,215}, {L,127}, {C, 35}, {L,211}, {L,119}, {L,123}, {L,115}, }, // zidx = 131
        { {C, 44}, {C,128}, {C, 40}, {C, 36}, {L,212}, {C, 32}, {L,124}, {L,116}, }, // zidx = 132
        { {C, 45}, {C,129}, {C, 41}, {C, 37}, {L,213}, {C, 33}, {L,125}, {L,117}, }, // zidx = 133
        { {C, 46}, {C,130}, {C, 42}, {C, 38}, {L,214}, {C, 34}, {L,126}, {L,118}, }, // zidx = 134
        { {C, 47}, {C,131}, {C, 43}, {C, 39}, {L,215}, {C, 35}, {L,127}, {L,119}, }, // zidx = 135
        { {C,128}, {L,220}, {L,212}, {C, 40}, {L,216}, {L,124}, {L,208}, {L,120}, }, // zidx = 136
        { {C,129}, {L,221}, {L,213}, {C, 41}, {L,217}, {L,125}, {L,209}, {L,121}, }, // zidx = 137
        { {C,130}, {L,222}, {L,214}, {C, 42}, {L,218}, {L,126}, {L,210}, {L,122}, }, // zidx = 138
        { {C,131}, {L,223}, {L,215}, {C, 43}, {L,219}, {L,127}, {L,211}, {L,123}, }, // zidx = 139
        { {C,132}, {C,136}, {C,128}, {C, 44}, {L,220}, {C, 40}, {L,212}, {L,124}, }, // zidx = 140
        { {C,133}, {C,137}, {C,129}, {C, 45}, {L,221}, {C, 41}, {L,213}, {L,125}, }, // zidx = 141
        { {C,134}, {C,138}, {C,130}, {C, 46}, {L,222}, {C, 42}, {L,214}, {L,126}, }, // zidx = 142
        { {C,135}, {C,139}, {C,131}, {C, 47}, {L,223}, {C, 43}, {L,215}, {L,127}, }, // zidx = 143
        { {C, 56}, {C,132}, {C, 44}, {C, 48}, {C,128}, {C, 36}, {C, 40}, {C, 32}, }, // zidx = 144
        { {C, 57}, {C,133}, {C, 45}, {C, 49}, {C,129}, {C, 37}, {C, 41}, {C, 33}, }, // zidx = 145
        { {C, 58}, {C,134}, {C, 46}, {C, 50}, {C,130}, {C, 38}, {C, 42}, {C, 34}, }, // zidx = 146
        { {C, 59}, {C,135}, {C, 47}, {C, 51}, {C,131}, {C, 39}, {C, 43}, {C, 35}, }, // zidx = 147
        { {C, 60}, {C,144}, {C, 56}, {C, 52}, {C,132}, {C, 48}, {C, 44}, {C, 36}, }, // zidx = 148
        { {C, 61}, {C,145}, {C, 57}, {C, 53}, {C,133}, {C, 49}, {C, 45}, {C, 37}, }, // zidx = 149
        { {C, 62}, {C,146}, {C, 58}, {C, 54}, {C,134}, {C, 50}, {C, 46}, {C, 38}, }, // zidx = 150
        { {C, 63}, {C,147}, {C, 59}, {C, 55}, {C,135}, {C, 51}, {C, 47}, {C, 39}, }, // zidx = 151
        { {C,144}, {C,140}, {C,132}, {C, 56}, {C,136}, {C, 44}, {C,128}, {C, 40}, }, // zidx = 152
        { {C,145}, {C,141}, {C,133}, {C, 57}, {C,137}, {C, 45}, {C,129}, {C, 41}, }, // zidx = 153
        { {C,146}, {C,142}, {C,134}, {C, 58}, {C,138}, {C, 46}, {C,130}, {C, 42}, }, // zidx = 154
        { {C,147}, {C,143}, {C,135}, {C, 59}, {C,139}, {C, 47}, {C,131}, {C, 43}, }, // zidx = 155
        { {C,148}, {C,152}, {C,144}, {C, 60}, {C,140}, {C, 56}, {C,132}, {C, 44}, }, // zidx = 156
        { {C,149}, {C,153}, {C,145}, {C, 61}, {C,141}, {C, 57}, {C,133}, {C, 45}, }, // zidx = 157
        { {C,150}, {C,154}, {C,146}, {C, 62}, {C,142}, {C, 58}, {C,134}, {C, 46}, }, // zidx = 158
        { {C,151}, {C,155}, {C,147}, {C, 63}, {C,143}, {C, 59}, {C,135}, {C, 47}, }, // zidx = 159
        { {C,136}, {L,244}, {L,220}, {C,128}, {L,240}, {L,212}, {L,216}, {L,208}, }, // zidx = 160
        { {C,137}, {L,245}, {L,221}, {C,129}, {L,241}, {L,213}, {L,217}, {L,209}, }, // zidx = 161
        { {C,138}, {L,246}, {L,222}, {C,130}, {L,242}, {L,214}, {L,218}, {L,210}, }, // zidx = 162
        { {C,139}, {L,247}, {L,223}, {C,131}, {L,243}, {L,215}, {L,219}, {L,211}, }, // zidx = 163
        { {C,140}, {C,160}, {C,136}, {C,132}, {L,244}, {C,128}, {L,220}, {L,212}, }, // zidx = 164
        { {C,141}, {C,161}, {C,137}, {C,133}, {L,245}, {C,129}, {L,221}, {L,213}, }, // zidx = 165
        { {C,142}, {C,162}, {C,138}, {C,134}, {L,246}, {C,130}, {L,222}, {L,214}, }, // zidx = 166
        { {C,143}, {C,163}, {C,139}, {C,135}, {L,247}, {C,131}, {L,223}, {L,215}, }, // zidx = 167
        { {C,160}, {L,252}, {L,244}, {C,136}, {L,248}, {L,220}, {L,240}, {L,216}, }, // zidx = 168
        { {C,161}, {L,253}, {L,245}, {C,137}, {L,249}, {L,221}, {L,241}, {L,217}, }, // zidx = 169
        { {C,162}, {L,254}, {L,246}, {C,138}, {L,250}, {L,222}, {L,242}, {L,218}, }, // zidx = 170
        { {C,163}, {L,255}, {L,247}, {C,139}, {L,251}, {L,223}, {L,243}, {L,219}, }, // zidx = 171
        { {C,164}, {C,168}, {C,160}, {C,140}, {L,252}, {C,136}, {L,244}, {L,220}, }, // zidx = 172
        { {C,165}, {C,169}, {C,161}, {C,141}, {L,253}, {C,137}, {L,245}, {L,221}, }, // zidx = 173
        { {C,166}, {C,170}, {C,162}, {C,142}, {L,254}, {C,138}, {L,246}, {L,222}, }, // zidx = 174
        { {C,167}, {C,171}, {C,163}, {C,143}, {L,255}, {C,139}, {L,247}, {L,223}, }, // zidx = 175
        { {C,152}, {C,164}, {C,140}, {C,144}, {C,160}, {C,132}, {C,136}, {C,128}, }, // zidx = 176
        { {C,153}, {C,165}, {C,141}, {C,145}, {C,161}, {C,133}, {C,137}, {C,129}, }, // zidx = 177
        { {C,154}, {C,166}, {C,142}, {C,146}, {C,162}, {C,134}, {C,138}, {C,130}, }, // zidx = 178
        { {C,155}, {C,167}, {C,143}, {C,147}, {C,163}, {C,135}, {C,139}, {C,131}, }, // zidx = 179
        { {C,156}, {C,176}, {C,152}, {C,148}, {C,164}, {C,144}, {C,140}, {C,132}, }, // zidx = 180
        { {C,157}, {C,177}, {C,153}, {C,149}, {C,165}, {C,145}, {C,141}, {C,133}, }, // zidx = 181
        { {C,158}, {C,178}, {C,154}, {C,150}, {C,166}, {C,146}, {C,142}, {C,134}, }, // zidx = 182
        { {C,159}, {C,179}, {C,155}, {C,151}, {C,167}, {C,147}, {C,143}, {C,135}, }, // zidx = 183
        { {C,176}, {C,172}, {C,164}, {C,152}, {C,168}, {C,140}, {C,160}, {C,136}, }, // zidx = 184
        { {C,177}, {C,173}, {C,165}, {C,153}, {C,169}, {C,141}, {C,161}, {C,137}, }, // zidx = 185
        { {C,178}, {C,174}, {C,166}, {C,154}, {C,170}, {C,142}, {C,162}, {C,138}, }, // zidx = 186
        { {C,179}, {C,175}, {C,167}, {C,155}, {C,171}, {C,143}, {C,163}, {C,139}, }, // zidx = 187
        { {C,180}, {C,184}, {C,176}, {C,156}, {C,172}, {C,152}, {C,164}, {C,140}, }, // zidx = 188
        { {C,181}, {C,185}, {C,177}, {C,157}, {C,173}, {C,153}, {C,165}, {C,141}, }, // zidx = 189
        { {C,182}, {C,186}, {C,178}, {C,158}, {C,174}, {C,154}, {C,166}, {C,142}, }, // zidx = 190
        { {C,183}, {C,187}, {C,179}, {C,159}, {C,175}, {C,155}, {C,167}, {C,143}, }, // zidx = 191
        { {C,104}, {C,148}, {C, 60}, {C, 96}, {C,144}, {C, 52}, {C, 56}, {C, 48}, }, // zidx = 192
        { {C,105}, {C,149}, {C, 61}, {C, 97}, {C,145}, {C, 53}, {C, 57}, {C, 49}, }, // zidx = 193
        { {C,106}, {C,150}, {C, 62}, {C, 98}, {C,146}, {C, 54}, {C, 58}, {C, 50}, }, // zidx = 194
        { {C,107}, {C,151}, {C, 63}, {C, 99}, {C,147}, {C, 55}, {C, 59}, {C, 51}, }, // zidx = 195
        { {C,108}, {C,192}, {C,104}, {C,100}, {C,148}, {C, 96}, {C, 60}, {C, 52}, }, // zidx = 196
        { {C,109}, {C,193}, {C,105}, {C,101}, {C,149}, {C, 97}, {C, 61}, {C, 53}, }, // zidx = 197
        { {C,110}, {C,194}, {C,106}, {C,102}, {C,150}, {C, 98}, {C, 62}, {C, 54}, }, // zidx = 198
        { {C,111}, {C,195}, {C,107}, {C,103}, {C,151}, {C, 99}, {C, 63}, {C, 55}, }, // zidx = 199
        { {C,192}, {C,156}, {C,148}, {C,104}, {C,152}, {C, 60}, {C,144}, {C, 56}, }, // zidx = 200
        { {C,193}, {C,157}, {C,149}, {C,105}, {C,153}, {C, 61}, {C,145}, {C, 57}, }, // zidx = 201
        { {C,194}, {C,158}, {C,150}, {C,106}, {C,154}, {C, 62}, {C,146}, {C, 58}, }, // zidx = 202
        { {C,195}, {C,159}, {C,151}, {C,107}, {C,155}, {C, 63}, {C,147}, {C, 59}, }, // zidx = 203
        { {C,196}, {C,200}, {C,192}, {C,108}, {C,156}, {C,104}, {C,148}, {C, 60}, }, // zidx = 204
        { {C,197}, {C,201}, {C,193}, {C,109}, {C,157}, {C,105}, {C,149}, {C, 61}, }, // zidx = 205
        { {C,198}, {C,202}, {C,194}, {C,110}, {C,158}, {C,106}, {C,150}, {C, 62}, }, // zidx = 206
        { {C,199}, {C,203}, {C,195}, {C,111}, {C,159}, {C,107}, {C,151}, {C, 63}, }, // zidx = 207
        { {C,120}, {C,196}, {C,108}, {C,112}, {C,192}, {C,100}, {C,104}, {C, 96}, }, // zidx = 208
        { {C,121}, {C,197}, {C,109}, {C,113}, {C,193}, {C,101}, {C,105}, {C, 97}, }, // zidx = 209
        { {C,122}, {C,198}, {C,110}, {C,114}, {C,194}, {C,102}, {C,106}, {C, 98}, }, // zidx = 210
        { {C,123}, {C,199}, {C,111}, {C,115}, {C,195}, {C,103}, {C,107}, {C, 99}, }, // zidx = 211
        { {C,124}, {C,208}, {C,120}, {C,116}, {C,196}, {C,112}, {C,108}, {C,100}, }, // zidx = 212
        { {C,125}, {C,209}, {C,121}, {C,117}, {C,197}, {C,113}, {C,109}, {C,101}, }, // zidx = 213
        { {C,126}, {C,210}, {C,122}, {C,118}, {C,198}, {C,114}, {C,110}, {C,102}, }, // zidx = 214
        { {C,127}, {C,211}, {C,123}, {C,119}, {C,199}, {C,115}, {C,111}, {C,103}, }, // zidx = 215
        { {C,208}, {C,204}, {C,196}, {C,120}, {C,200}, {C,108}, {C,192}, {C,104}, }, // zidx = 216
        { {C,209}, {C,205}, {C,197}, {C,121}, {C,201}, {C,109}, {C,193}, {C,105}, }, // zidx = 217
        { {C,210}, {C,206}, {C,198}, {C,122}, {C,202}, {C,110}, {C,194}, {C,106}, }, // zidx = 218
        { {C,211}, {C,207}, {C,199}, {C,123}, {C,203}, {C,111}, {C,195}, {C,107}, }, // zidx = 219
        { {C,212}, {C,216}, {C,208}, {C,124}, {C,204}, {C,120}, {C,196}, {C,108}, }, // zidx = 220
        { {C,213}, {C,217}, {C,209}, {C,125}, {C,205}, {C,121}, {C,197}, {C,109}, }, // zidx = 221
        { {C,214}, {C,218}, {C,210}, {C,126}, {C,206}, {C,122}, {C,198}, {C,110}, }, // zidx = 222
        { {C,215}, {C,219}, {C,211}, {C,127}, {C,207}, {C,123}, {C,199}, {C,111}, }, // zidx = 223
        { {C,200}, {C,180}, {C,156}, {C,192}, {C,176}, {C,148}, {C,152}, {C,144}, }, // zidx = 224
        { {C,201}, {C,181}, {C,157}, {C,193}, {C,177}, {C,149}, {C,153}, {C,145}, }, // zidx = 225
        { {C,202}, {C,182}, {C,158}, {C,194}, {C,178}, {C,150}, {C,154}, {C,146}, }, // zidx = 226
        { {C,203}, {C,183}, {C,159}, {C,195}, {C,179}, {C,151}, {C,155}, {C,147}, }, // zidx = 227
        { {C,204}, {C,224}, {C,200}, {C,196}, {C,180}, {C,192}, {C,156}, {C,148}, }, // zidx = 228
        { {C,205}, {C,225}, {C,201}, {C,197}, {C,181}, {C,193}, {C,157}, {C,149}, }, // zidx = 229
        { {C,206}, {C,226}, {C,202}, {C,198}, {C,182}, {C,194}, {C,158}, {C,150}, }, // zidx = 230
        { {C,207}, {C,227}, {C,203}, {C,199}, {C,183}, {C,195}, {C,159}, {C,151}, }, // zidx = 231
        { {C,224}, {C,188}, {C,180}, {C,200}, {C,184}, {C,156}, {C,176}, {C,152}, }, // zidx = 232
        { {C,225}, {C,189}, {C,181}, {C,201}, {C,185}, {C,157}, {C,177}, {C,153}, }, // zidx = 233
        { {C,226}, {C,190}, {C,182}, {C,202}, {C,186}, {C,158}, {C,178}, {C,154}, }, // zidx = 234
        { {C,227}, {C,191}, {C,183}, {C,203}, {C,187}, {C,159}, {C,179}, {C,155}, }, // zidx = 235
        { {C,228}, {C,232}, {C,224}, {C,204}, {C,188}, {C,200}, {C,180}, {C,156}, }, // zidx = 236
        { {C,229}, {C,233}, {C,225}, {C,205}, {C,189}, {C,201}, {C,181}, {C,157}, }, // zidx = 237
        { {C,230}, {C,234}, {C,226}, {C,206}, {C,190}, {C,202}, {C,182}, {C,158}, }, // zidx = 238
        { {C,231}, {C,235}, {C,227}, {C,207}, {C,191}, {C,203}, {C,183}, {C,159}, }, // zidx = 239
        { {C,216}, {C,228}, {C,204}, {C,208}, {C,224}, {C,196}, {C,200}, {C,192}, }, // zidx = 240
        { {C,217}, {C,229}, {C,205}, {C,209}, {C,225}, {C,197}, {C,201}, {C,193}, }, // zidx = 241
        { {C,218}, {C,230}, {C,206}, {C,210}, {C,226}, {C,198}, {C,202}, {C,194}, }, // zidx = 242
        { {C,219}, {C,231}, {C,207}, {C,211}, {C,227}, {C,199}, {C,203}, {C,195}, }, // zidx = 243
        { {C,220}, {C,240}, {C,216}, {C,212}, {C,228}, {C,208}, {C,204}, {C,196}, }, // zidx = 244
        { {C,221}, {C,241}, {C,217}, {C,213}, {C,229}, {C,209}, {C,205}, {C,197}, }, // zidx = 245
        { {C,222}, {C,242}, {C,218}, {C,214}, {C,230}, {C,210}, {C,206}, {C,198}, }, // zidx = 246
        { {C,223}, {C,243}, {C,219}, {C,215}, {C,231}, {C,211}, {C,207}, {C,199}, }, // zidx = 247
        { {C,240}, {C,236}, {C,228}, {C,216}, {C,232}, {C,204}, {C,224}, {C,200}, }, // zidx = 248
        { {C,241}, {C,237}, {C,229}, {C,217}, {C,233}, {C,205}, {C,225}, {C,201}, }, // zidx = 249
        { {C,242}, {C,238}, {C,230}, {C,218}, {C,234}, {C,206}, {C,226}, {C,202}, }, // zidx = 250
        { {C,243}, {C,239}, {C,231}, {C,219}, {C,235}, {C,207}, {C,227}, {C,203}, }, // zidx = 251
        { {C,244}, {C,248}, {C,240}, {C,220}, {C,236}, {C,216}, {C,228}, {C,204}, }, // zidx = 252
        { {C,245}, {C,249}, {C,241}, {C,221}, {C,237}, {C,217}, {C,229}, {C,205}, }, // zidx = 253
        { {C,246}, {C,250}, {C,242}, {C,222}, {C,238}, {C,218}, {C,230}, {C,206}, }, // zidx = 254
        { {C,247}, {C,251}, {C,243}, {C,223}, {C,239}, {C,219}, {C,231}, {C,207}, }, // zidx = 255
    };

    const MvRefLoc mv_ref_locations_4x8[128][8] = {
        { {A,168}, {L, 84}, {D,252}, {A,160}, {L, 80}, {D,244}, {D,248}, {D,240}, }, // zidx = 0
        { {A,169}, {L, 85}, {D,253}, {A,161}, {L, 81}, {D,245}, {D,249}, {D,241}, }, // zidx = 1
        { {A,172}, {C,  0}, {A,168}, {A,164}, {L, 84}, {A,160}, {D,252}, {D,244}, }, // zidx = 4
        { {A,173}, {C,  1}, {A,169}, {A,165}, {L, 85}, {A,161}, {D,253}, {D,245}, }, // zidx = 5
        { {C,  0}, {L, 92}, {L, 84}, {A,168}, {L, 88}, {D,252}, {L, 80}, {D,248}, }, // zidx = 8
        { {C,  1}, {L, 93}, {L, 85}, {A,169}, {L, 89}, {D,253}, {L, 81}, {D,249}, }, // zidx = 9
        { {C,  4}, {C,  8}, {C,  0}, {A,172}, {L, 92}, {A,168}, {L, 84}, {D,252}, }, // zidx = 12
        { {C,  5}, {C,  9}, {C,  1}, {A,173}, {L, 93}, {A,169}, {L, 85}, {D,253}, }, // zidx = 13
        { {A,184}, {C,  4}, {A,172}, {A,176}, {C,  0}, {A,164}, {A,168}, {A,160}, }, // zidx = 16
        { {A,185}, {C,  5}, {A,173}, {A,177}, {C,  1}, {A,165}, {A,169}, {A,161}, }, // zidx = 17
        { {A,188}, {C, 16}, {A,184}, {A,180}, {C,  4}, {A,176}, {A,172}, {A,164}, }, // zidx = 20
        { {A,189}, {C, 17}, {A,185}, {A,181}, {C,  5}, {A,177}, {A,173}, {A,165}, }, // zidx = 21
        { {C, 16}, {C, 12}, {C,  4}, {A,184}, {C,  8}, {A,172}, {C,  0}, {A,168}, }, // zidx = 24
        { {C, 17}, {C, 13}, {C,  5}, {A,185}, {C,  9}, {A,173}, {C,  1}, {A,169}, }, // zidx = 25
        { {C, 20}, {C, 24}, {C, 16}, {A,188}, {C, 12}, {A,184}, {C,  4}, {A,172}, }, // zidx = 28
        { {C, 21}, {C, 25}, {C, 17}, {A,189}, {C, 13}, {A,185}, {C,  5}, {A,173}, }, // zidx = 29
        { {C,  8}, {L,116}, {L, 92}, {C,  0}, {L,112}, {L, 84}, {L, 88}, {L, 80}, }, // zidx = 32
        { {C,  9}, {L,117}, {L, 93}, {C,  1}, {L,113}, {L, 85}, {L, 89}, {L, 81}, }, // zidx = 33
        { {C, 12}, {C, 32}, {C,  8}, {C,  4}, {L,116}, {C,  0}, {L, 92}, {L, 84}, }, // zidx = 36
        { {C, 13}, {C, 33}, {C,  9}, {C,  5}, {L,117}, {C,  1}, {L, 93}, {L, 85}, }, // zidx = 37
        { {C, 32}, {L,124}, {L,116}, {C,  8}, {L,120}, {L, 92}, {L,112}, {L, 88}, }, // zidx = 40
        { {C, 33}, {L,125}, {L,117}, {C,  9}, {L,121}, {L, 93}, {L,113}, {L, 89}, }, // zidx = 41
        { {C, 36}, {C, 40}, {C, 32}, {C, 12}, {L,124}, {C,  8}, {L,116}, {L, 92}, }, // zidx = 44
        { {C, 37}, {C, 41}, {C, 33}, {C, 13}, {L,125}, {C,  9}, {L,117}, {L, 93}, }, // zidx = 45
        { {C, 24}, {C, 36}, {C, 12}, {C, 16}, {C, 32}, {C,  4}, {C,  8}, {C,  0}, }, // zidx = 48
        { {C, 25}, {C, 37}, {C, 13}, {C, 17}, {C, 33}, {C,  5}, {C,  9}, {C,  1}, }, // zidx = 49
        { {C, 28}, {C, 48}, {C, 24}, {C, 20}, {C, 36}, {C, 16}, {C, 12}, {C,  4}, }, // zidx = 52
        { {C, 29}, {C, 49}, {C, 25}, {C, 21}, {C, 37}, {C, 17}, {C, 13}, {C,  5}, }, // zidx = 53
        { {C, 48}, {C, 44}, {C, 36}, {C, 24}, {C, 40}, {C, 12}, {C, 32}, {C,  8}, }, // zidx = 56
        { {C, 49}, {C, 45}, {C, 37}, {C, 25}, {C, 41}, {C, 13}, {C, 33}, {C,  9}, }, // zidx = 57
        { {C, 52}, {C, 56}, {C, 48}, {C, 28}, {C, 44}, {C, 24}, {C, 36}, {C, 12}, }, // zidx = 60
        { {C, 53}, {C, 57}, {C, 49}, {C, 29}, {C, 45}, {C, 25}, {C, 37}, {C, 13}, }, // zidx = 61
        { {A,232}, {C, 20}, {A,188}, {A,224}, {C, 16}, {A,180}, {A,184}, {A,176}, }, // zidx = 64
        { {A,233}, {C, 21}, {A,189}, {A,225}, {C, 17}, {A,181}, {A,185}, {A,177}, }, // zidx = 65
        { {A,236}, {C, 64}, {A,232}, {A,228}, {C, 20}, {A,224}, {A,188}, {A,180}, }, // zidx = 68
        { {A,237}, {C, 65}, {A,233}, {A,229}, {C, 21}, {A,225}, {A,189}, {A,181}, }, // zidx = 69
        { {C, 64}, {C, 28}, {C, 20}, {A,232}, {C, 24}, {A,188}, {C, 16}, {A,184}, }, // zidx = 72
        { {C, 65}, {C, 29}, {C, 21}, {A,233}, {C, 25}, {A,189}, {C, 17}, {A,185}, }, // zidx = 73
        { {C, 68}, {C, 72}, {C, 64}, {A,236}, {C, 28}, {A,232}, {C, 20}, {A,188}, }, // zidx = 76
        { {C, 69}, {C, 73}, {C, 65}, {A,237}, {C, 29}, {A,233}, {C, 21}, {A,189}, }, // zidx = 77
        { {A,248}, {C, 68}, {A,236}, {A,240}, {C, 64}, {A,228}, {A,232}, {A,224}, }, // zidx = 80
        { {A,249}, {C, 69}, {A,237}, {A,241}, {C, 65}, {A,229}, {A,233}, {A,225}, }, // zidx = 81
        { {A,252}, {C, 80}, {A,248}, {A,244}, {C, 68}, {A,240}, {A,236}, {A,228}, }, // zidx = 84
        { {A,253}, {C, 81}, {A,249}, {A,245}, {C, 69}, {A,241}, {A,237}, {A,229}, }, // zidx = 85
        { {C, 80}, {C, 76}, {C, 68}, {A,248}, {C, 72}, {A,236}, {C, 64}, {A,232}, }, // zidx = 88
        { {C, 81}, {C, 77}, {C, 69}, {A,249}, {C, 73}, {A,237}, {C, 65}, {A,233}, }, // zidx = 89
        { {C, 84}, {C, 88}, {C, 80}, {A,252}, {C, 76}, {A,248}, {C, 68}, {A,236}, }, // zidx = 92
        { {C, 85}, {C, 89}, {C, 81}, {A,253}, {C, 77}, {A,249}, {C, 69}, {A,237}, }, // zidx = 93
        { {C, 72}, {C, 52}, {C, 28}, {C, 64}, {C, 48}, {C, 20}, {C, 24}, {C, 16}, }, // zidx = 96
        { {C, 73}, {C, 53}, {C, 29}, {C, 65}, {C, 49}, {C, 21}, {C, 25}, {C, 17}, }, // zidx = 97
        { {C, 76}, {C, 96}, {C, 72}, {C, 68}, {C, 52}, {C, 64}, {C, 28}, {C, 20}, }, // zidx = 100
        { {C, 77}, {C, 97}, {C, 73}, {C, 69}, {C, 53}, {C, 65}, {C, 29}, {C, 21}, }, // zidx = 101
        { {C, 96}, {C, 60}, {C, 52}, {C, 72}, {C, 56}, {C, 28}, {C, 48}, {C, 24}, }, // zidx = 104
        { {C, 97}, {C, 61}, {C, 53}, {C, 73}, {C, 57}, {C, 29}, {C, 49}, {C, 25}, }, // zidx = 105
        { {C,100}, {C,104}, {C, 96}, {C, 76}, {C, 60}, {C, 72}, {C, 52}, {C, 28}, }, // zidx = 108
        { {C,101}, {C,105}, {C, 97}, {C, 77}, {C, 61}, {C, 73}, {C, 53}, {C, 29}, }, // zidx = 109
        { {C, 88}, {C,100}, {C, 76}, {C, 80}, {C, 96}, {C, 68}, {C, 72}, {C, 64}, }, // zidx = 112
        { {C, 89}, {C,101}, {C, 77}, {C, 81}, {C, 97}, {C, 69}, {C, 73}, {C, 65}, }, // zidx = 113
        { {C, 92}, {C,112}, {C, 88}, {C, 84}, {C,100}, {C, 80}, {C, 76}, {C, 68}, }, // zidx = 116
        { {C, 93}, {C,113}, {C, 89}, {C, 85}, {C,101}, {C, 81}, {C, 77}, {C, 69}, }, // zidx = 117
        { {C,112}, {C,108}, {C,100}, {C, 88}, {C,104}, {C, 76}, {C, 96}, {C, 72}, }, // zidx = 120
        { {C,113}, {C,109}, {C,101}, {C, 89}, {C,105}, {C, 77}, {C, 97}, {C, 73}, }, // zidx = 121
        { {C,116}, {C,120}, {C,112}, {C, 92}, {C,108}, {C, 88}, {C,100}, {C, 76}, }, // zidx = 124
        { {C,117}, {C,121}, {C,113}, {C, 93}, {C,109}, {C, 89}, {C,101}, {C, 77}, }, // zidx = 125
        { {C, 40}, {L,212}, {L,124}, {C, 32}, {L,208}, {L,116}, {L,120}, {L,112}, }, // zidx = 128
        { {C, 41}, {L,213}, {L,125}, {C, 33}, {L,209}, {L,117}, {L,121}, {L,113}, }, // zidx = 129
        { {C, 44}, {C,128}, {C, 40}, {C, 36}, {L,212}, {C, 32}, {L,124}, {L,116}, }, // zidx = 132
        { {C, 45}, {C,129}, {C, 41}, {C, 37}, {L,213}, {C, 33}, {L,125}, {L,117}, }, // zidx = 133
        { {C,128}, {L,220}, {L,212}, {C, 40}, {L,216}, {L,124}, {L,208}, {L,120}, }, // zidx = 136
        { {C,129}, {L,221}, {L,213}, {C, 41}, {L,217}, {L,125}, {L,209}, {L,121}, }, // zidx = 137
        { {C,132}, {C,136}, {C,128}, {C, 44}, {L,220}, {C, 40}, {L,212}, {L,124}, }, // zidx = 140
        { {C,133}, {C,137}, {C,129}, {C, 45}, {L,221}, {C, 41}, {L,213}, {L,125}, }, // zidx = 141
        { {C, 56}, {C,132}, {C, 44}, {C, 48}, {C,128}, {C, 36}, {C, 40}, {C, 32}, }, // zidx = 144
        { {C, 57}, {C,133}, {C, 45}, {C, 49}, {C,129}, {C, 37}, {C, 41}, {C, 33}, }, // zidx = 145
        { {C, 60}, {C,144}, {C, 56}, {C, 52}, {C,132}, {C, 48}, {C, 44}, {C, 36}, }, // zidx = 148
        { {C, 61}, {C,145}, {C, 57}, {C, 53}, {C,133}, {C, 49}, {C, 45}, {C, 37}, }, // zidx = 149
        { {C,144}, {C,140}, {C,132}, {C, 56}, {C,136}, {C, 44}, {C,128}, {C, 40}, }, // zidx = 152
        { {C,145}, {C,141}, {C,133}, {C, 57}, {C,137}, {C, 45}, {C,129}, {C, 41}, }, // zidx = 153
        { {C,148}, {C,152}, {C,144}, {C, 60}, {C,140}, {C, 56}, {C,132}, {C, 44}, }, // zidx = 156
        { {C,149}, {C,153}, {C,145}, {C, 61}, {C,141}, {C, 57}, {C,133}, {C, 45}, }, // zidx = 157
        { {C,136}, {L,244}, {L,220}, {C,128}, {L,240}, {L,212}, {L,216}, {L,208}, }, // zidx = 160
        { {C,137}, {L,245}, {L,221}, {C,129}, {L,241}, {L,213}, {L,217}, {L,209}, }, // zidx = 161
        { {C,140}, {C,160}, {C,136}, {C,132}, {L,244}, {C,128}, {L,220}, {L,212}, }, // zidx = 164
        { {C,141}, {C,161}, {C,137}, {C,133}, {L,245}, {C,129}, {L,221}, {L,213}, }, // zidx = 165
        { {C,160}, {L,252}, {L,244}, {C,136}, {L,248}, {L,220}, {L,240}, {L,216}, }, // zidx = 168
        { {C,161}, {L,253}, {L,245}, {C,137}, {L,249}, {L,221}, {L,241}, {L,217}, }, // zidx = 169
        { {C,164}, {C,168}, {C,160}, {C,140}, {L,252}, {C,136}, {L,244}, {L,220}, }, // zidx = 172
        { {C,165}, {C,169}, {C,161}, {C,141}, {L,253}, {C,137}, {L,245}, {L,221}, }, // zidx = 173
        { {C,152}, {C,164}, {C,140}, {C,144}, {C,160}, {C,132}, {C,136}, {C,128}, }, // zidx = 176
        { {C,153}, {C,165}, {C,141}, {C,145}, {C,161}, {C,133}, {C,137}, {C,129}, }, // zidx = 177
        { {C,156}, {C,176}, {C,152}, {C,148}, {C,164}, {C,144}, {C,140}, {C,132}, }, // zidx = 180
        { {C,157}, {C,177}, {C,153}, {C,149}, {C,165}, {C,145}, {C,141}, {C,133}, }, // zidx = 181
        { {C,176}, {C,172}, {C,164}, {C,152}, {C,168}, {C,140}, {C,160}, {C,136}, }, // zidx = 184
        { {C,177}, {C,173}, {C,165}, {C,153}, {C,169}, {C,141}, {C,161}, {C,137}, }, // zidx = 185
        { {C,180}, {C,184}, {C,176}, {C,156}, {C,172}, {C,152}, {C,164}, {C,140}, }, // zidx = 188
        { {C,181}, {C,185}, {C,177}, {C,157}, {C,173}, {C,153}, {C,165}, {C,141}, }, // zidx = 189
        { {C,104}, {C,148}, {C, 60}, {C, 96}, {C,144}, {C, 52}, {C, 56}, {C, 48}, }, // zidx = 192
        { {C,105}, {C,149}, {C, 61}, {C, 97}, {C,145}, {C, 53}, {C, 57}, {C, 49}, }, // zidx = 193
        { {C,108}, {C,192}, {C,104}, {C,100}, {C,148}, {C, 96}, {C, 60}, {C, 52}, }, // zidx = 196
        { {C,109}, {C,193}, {C,105}, {C,101}, {C,149}, {C, 97}, {C, 61}, {C, 53}, }, // zidx = 197
        { {C,192}, {C,156}, {C,148}, {C,104}, {C,152}, {C, 60}, {C,144}, {C, 56}, }, // zidx = 200
        { {C,193}, {C,157}, {C,149}, {C,105}, {C,153}, {C, 61}, {C,145}, {C, 57}, }, // zidx = 201
        { {C,196}, {C,200}, {C,192}, {C,108}, {C,156}, {C,104}, {C,148}, {C, 60}, }, // zidx = 204
        { {C,197}, {C,201}, {C,193}, {C,109}, {C,157}, {C,105}, {C,149}, {C, 61}, }, // zidx = 205
        { {C,120}, {C,196}, {C,108}, {C,112}, {C,192}, {C,100}, {C,104}, {C, 96}, }, // zidx = 208
        { {C,121}, {C,197}, {C,109}, {C,113}, {C,193}, {C,101}, {C,105}, {C, 97}, }, // zidx = 209
        { {C,124}, {C,208}, {C,120}, {C,116}, {C,196}, {C,112}, {C,108}, {C,100}, }, // zidx = 212
        { {C,125}, {C,209}, {C,121}, {C,117}, {C,197}, {C,113}, {C,109}, {C,101}, }, // zidx = 213
        { {C,208}, {C,204}, {C,196}, {C,120}, {C,200}, {C,108}, {C,192}, {C,104}, }, // zidx = 216
        { {C,209}, {C,205}, {C,197}, {C,121}, {C,201}, {C,109}, {C,193}, {C,105}, }, // zidx = 217
        { {C,212}, {C,216}, {C,208}, {C,124}, {C,204}, {C,120}, {C,196}, {C,108}, }, // zidx = 220
        { {C,213}, {C,217}, {C,209}, {C,125}, {C,205}, {C,121}, {C,197}, {C,109}, }, // zidx = 221
        { {C,200}, {C,180}, {C,156}, {C,192}, {C,176}, {C,148}, {C,152}, {C,144}, }, // zidx = 224
        { {C,201}, {C,181}, {C,157}, {C,193}, {C,177}, {C,149}, {C,153}, {C,145}, }, // zidx = 225
        { {C,204}, {C,224}, {C,200}, {C,196}, {C,180}, {C,192}, {C,156}, {C,148}, }, // zidx = 228
        { {C,205}, {C,225}, {C,201}, {C,197}, {C,181}, {C,193}, {C,157}, {C,149}, }, // zidx = 229
        { {C,224}, {C,188}, {C,180}, {C,200}, {C,184}, {C,156}, {C,176}, {C,152}, }, // zidx = 232
        { {C,225}, {C,189}, {C,181}, {C,201}, {C,185}, {C,157}, {C,177}, {C,153}, }, // zidx = 233
        { {C,228}, {C,232}, {C,224}, {C,204}, {C,188}, {C,200}, {C,180}, {C,156}, }, // zidx = 236
        { {C,229}, {C,233}, {C,225}, {C,205}, {C,189}, {C,201}, {C,181}, {C,157}, }, // zidx = 237
        { {C,216}, {C,228}, {C,204}, {C,208}, {C,224}, {C,196}, {C,200}, {C,192}, }, // zidx = 240
        { {C,217}, {C,229}, {C,205}, {C,209}, {C,225}, {C,197}, {C,201}, {C,193}, }, // zidx = 241
        { {C,220}, {C,240}, {C,216}, {C,212}, {C,228}, {C,208}, {C,204}, {C,196}, }, // zidx = 244
        { {C,221}, {C,241}, {C,217}, {C,213}, {C,229}, {C,209}, {C,205}, {C,197}, }, // zidx = 245
        { {C,240}, {C,236}, {C,228}, {C,216}, {C,232}, {C,204}, {C,224}, {C,200}, }, // zidx = 248
        { {C,241}, {C,237}, {C,229}, {C,217}, {C,233}, {C,205}, {C,225}, {C,201}, }, // zidx = 249
        { {C,244}, {C,248}, {C,240}, {C,220}, {C,236}, {C,216}, {C,228}, {C,204}, }, // zidx = 252
        { {C,245}, {C,249}, {C,241}, {C,221}, {C,237}, {C,217}, {C,229}, {C,205}, }, // zidx = 253
    };

    const MvRefLoc mv_ref_locations_8x4[128][8] = {
        { {A,168}, {L, 84}, {D,252}, {A,160}, {L, 80}, {D,244}, {D,248}, {D,240}, }, // zidx = 0
        { {A,170}, {L, 86}, {D,254}, {A,162}, {L, 82}, {D,246}, {D,250}, {D,242}, }, // zidx = 2
        { {A,172}, {C,  0}, {A,168}, {A,164}, {L, 84}, {A,160}, {D,252}, {D,244}, }, // zidx = 4
        { {A,174}, {C,  2}, {A,170}, {A,166}, {L, 86}, {A,162}, {D,254}, {D,246}, }, // zidx = 6
        { {C,  0}, {L, 92}, {L, 84}, {A,168}, {L, 88}, {D,252}, {L, 80}, {D,248}, }, // zidx = 8
        { {C,  2}, {L, 94}, {L, 86}, {A,170}, {L, 90}, {D,254}, {L, 82}, {D,250}, }, // zidx = 10
        { {C,  4}, {C,  8}, {C,  0}, {A,172}, {L, 92}, {A,168}, {L, 84}, {D,252}, }, // zidx = 12
        { {C,  6}, {C, 10}, {C,  2}, {A,174}, {L, 94}, {A,170}, {L, 86}, {D,254}, }, // zidx = 14
        { {A,184}, {C,  4}, {A,172}, {A,176}, {C,  0}, {A,164}, {A,168}, {A,160}, }, // zidx = 16
        { {A,186}, {C,  6}, {A,174}, {A,178}, {C,  2}, {A,166}, {A,170}, {A,162}, }, // zidx = 18
        { {A,188}, {C, 16}, {A,184}, {A,180}, {C,  4}, {A,176}, {A,172}, {A,164}, }, // zidx = 20
        { {A,190}, {C, 18}, {A,186}, {A,182}, {C,  6}, {A,178}, {A,174}, {A,166}, }, // zidx = 22
        { {C, 16}, {C, 12}, {C,  4}, {A,184}, {C,  8}, {A,172}, {C,  0}, {A,168}, }, // zidx = 24
        { {C, 18}, {C, 14}, {C,  6}, {A,186}, {C, 10}, {A,174}, {C,  2}, {A,170}, }, // zidx = 26
        { {C, 20}, {C, 24}, {C, 16}, {A,188}, {C, 12}, {A,184}, {C,  4}, {A,172}, }, // zidx = 28
        { {C, 22}, {C, 26}, {C, 18}, {A,190}, {C, 14}, {A,186}, {C,  6}, {A,174}, }, // zidx = 30
        { {C,  8}, {L,116}, {L, 92}, {C,  0}, {L,112}, {L, 84}, {L, 88}, {L, 80}, }, // zidx = 32
        { {C, 10}, {L,118}, {L, 94}, {C,  2}, {L,114}, {L, 86}, {L, 90}, {L, 82}, }, // zidx = 34
        { {C, 12}, {C, 32}, {C,  8}, {C,  4}, {L,116}, {C,  0}, {L, 92}, {L, 84}, }, // zidx = 36
        { {C, 14}, {C, 34}, {C, 10}, {C,  6}, {L,118}, {C,  2}, {L, 94}, {L, 86}, }, // zidx = 38
        { {C, 32}, {L,124}, {L,116}, {C,  8}, {L,120}, {L, 92}, {L,112}, {L, 88}, }, // zidx = 40
        { {C, 34}, {L,126}, {L,118}, {C, 10}, {L,122}, {L, 94}, {L,114}, {L, 90}, }, // zidx = 42
        { {C, 36}, {C, 40}, {C, 32}, {C, 12}, {L,124}, {C,  8}, {L,116}, {L, 92}, }, // zidx = 44
        { {C, 38}, {C, 42}, {C, 34}, {C, 14}, {L,126}, {C, 10}, {L,118}, {L, 94}, }, // zidx = 46
        { {C, 24}, {C, 36}, {C, 12}, {C, 16}, {C, 32}, {C,  4}, {C,  8}, {C,  0}, }, // zidx = 48
        { {C, 26}, {C, 38}, {C, 14}, {C, 18}, {C, 34}, {C,  6}, {C, 10}, {C,  2}, }, // zidx = 50
        { {C, 28}, {C, 48}, {C, 24}, {C, 20}, {C, 36}, {C, 16}, {C, 12}, {C,  4}, }, // zidx = 52
        { {C, 30}, {C, 50}, {C, 26}, {C, 22}, {C, 38}, {C, 18}, {C, 14}, {C,  6}, }, // zidx = 54
        { {C, 48}, {C, 44}, {C, 36}, {C, 24}, {C, 40}, {C, 12}, {C, 32}, {C,  8}, }, // zidx = 56
        { {C, 50}, {C, 46}, {C, 38}, {C, 26}, {C, 42}, {C, 14}, {C, 34}, {C, 10}, }, // zidx = 58
        { {C, 52}, {C, 56}, {C, 48}, {C, 28}, {C, 44}, {C, 24}, {C, 36}, {C, 12}, }, // zidx = 60
        { {C, 54}, {C, 58}, {C, 50}, {C, 30}, {C, 46}, {C, 26}, {C, 38}, {C, 14}, }, // zidx = 62
        { {A,232}, {C, 20}, {A,188}, {A,224}, {C, 16}, {A,180}, {A,184}, {A,176}, }, // zidx = 64
        { {A,234}, {C, 22}, {A,190}, {A,226}, {C, 18}, {A,182}, {A,186}, {A,178}, }, // zidx = 66
        { {A,236}, {C, 64}, {A,232}, {A,228}, {C, 20}, {A,224}, {A,188}, {A,180}, }, // zidx = 68
        { {A,238}, {C, 66}, {A,234}, {A,230}, {C, 22}, {A,226}, {A,190}, {A,182}, }, // zidx = 70
        { {C, 64}, {C, 28}, {C, 20}, {A,232}, {C, 24}, {A,188}, {C, 16}, {A,184}, }, // zidx = 72
        { {C, 66}, {C, 30}, {C, 22}, {A,234}, {C, 26}, {A,190}, {C, 18}, {A,186}, }, // zidx = 74
        { {C, 68}, {C, 72}, {C, 64}, {A,236}, {C, 28}, {A,232}, {C, 20}, {A,188}, }, // zidx = 76
        { {C, 70}, {C, 74}, {C, 66}, {A,238}, {C, 30}, {A,234}, {C, 22}, {A,190}, }, // zidx = 78
        { {A,248}, {C, 68}, {A,236}, {A,240}, {C, 64}, {A,228}, {A,232}, {A,224}, }, // zidx = 80
        { {A,250}, {C, 70}, {A,238}, {A,242}, {C, 66}, {A,230}, {A,234}, {A,226}, }, // zidx = 82
        { {A,252}, {C, 80}, {A,248}, {A,244}, {C, 68}, {A,240}, {A,236}, {A,228}, }, // zidx = 84
        { {A,254}, {C, 82}, {A,250}, {A,246}, {C, 70}, {A,242}, {A,238}, {A,230}, }, // zidx = 86
        { {C, 80}, {C, 76}, {C, 68}, {A,248}, {C, 72}, {A,236}, {C, 64}, {A,232}, }, // zidx = 88
        { {C, 82}, {C, 78}, {C, 70}, {A,250}, {C, 74}, {A,238}, {C, 66}, {A,234}, }, // zidx = 90
        { {C, 84}, {C, 88}, {C, 80}, {A,252}, {C, 76}, {A,248}, {C, 68}, {A,236}, }, // zidx = 92
        { {C, 86}, {C, 90}, {C, 82}, {A,254}, {C, 78}, {A,250}, {C, 70}, {A,238}, }, // zidx = 94
        { {C, 72}, {C, 52}, {C, 28}, {C, 64}, {C, 48}, {C, 20}, {C, 24}, {C, 16}, }, // zidx = 96
        { {C, 74}, {C, 54}, {C, 30}, {C, 66}, {C, 50}, {C, 22}, {C, 26}, {C, 18}, }, // zidx = 98
        { {C, 76}, {C, 96}, {C, 72}, {C, 68}, {C, 52}, {C, 64}, {C, 28}, {C, 20}, }, // zidx = 100
        { {C, 78}, {C, 98}, {C, 74}, {C, 70}, {C, 54}, {C, 66}, {C, 30}, {C, 22}, }, // zidx = 102
        { {C, 96}, {C, 60}, {C, 52}, {C, 72}, {C, 56}, {C, 28}, {C, 48}, {C, 24}, }, // zidx = 104
        { {C, 98}, {C, 62}, {C, 54}, {C, 74}, {C, 58}, {C, 30}, {C, 50}, {C, 26}, }, // zidx = 106
        { {C,100}, {C,104}, {C, 96}, {C, 76}, {C, 60}, {C, 72}, {C, 52}, {C, 28}, }, // zidx = 108
        { {C,102}, {C,106}, {C, 98}, {C, 78}, {C, 62}, {C, 74}, {C, 54}, {C, 30}, }, // zidx = 110
        { {C, 88}, {C,100}, {C, 76}, {C, 80}, {C, 96}, {C, 68}, {C, 72}, {C, 64}, }, // zidx = 112
        { {C, 90}, {C,102}, {C, 78}, {C, 82}, {C, 98}, {C, 70}, {C, 74}, {C, 66}, }, // zidx = 114
        { {C, 92}, {C,112}, {C, 88}, {C, 84}, {C,100}, {C, 80}, {C, 76}, {C, 68}, }, // zidx = 116
        { {C, 94}, {C,114}, {C, 90}, {C, 86}, {C,102}, {C, 82}, {C, 78}, {C, 70}, }, // zidx = 118
        { {C,112}, {C,108}, {C,100}, {C, 88}, {C,104}, {C, 76}, {C, 96}, {C, 72}, }, // zidx = 120
        { {C,114}, {C,110}, {C,102}, {C, 90}, {C,106}, {C, 78}, {C, 98}, {C, 74}, }, // zidx = 122
        { {C,116}, {C,120}, {C,112}, {C, 92}, {C,108}, {C, 88}, {C,100}, {C, 76}, }, // zidx = 124
        { {C,118}, {C,122}, {C,114}, {C, 94}, {C,110}, {C, 90}, {C,102}, {C, 78}, }, // zidx = 126
        { {C, 40}, {L,212}, {L,124}, {C, 32}, {L,208}, {L,116}, {L,120}, {L,112}, }, // zidx = 128
        { {C, 42}, {L,214}, {L,126}, {C, 34}, {L,210}, {L,118}, {L,122}, {L,114}, }, // zidx = 130
        { {C, 44}, {C,128}, {C, 40}, {C, 36}, {L,212}, {C, 32}, {L,124}, {L,116}, }, // zidx = 132
        { {C, 46}, {C,130}, {C, 42}, {C, 38}, {L,214}, {C, 34}, {L,126}, {L,118}, }, // zidx = 134
        { {C,128}, {L,220}, {L,212}, {C, 40}, {L,216}, {L,124}, {L,208}, {L,120}, }, // zidx = 136
        { {C,130}, {L,222}, {L,214}, {C, 42}, {L,218}, {L,126}, {L,210}, {L,122}, }, // zidx = 138
        { {C,132}, {C,136}, {C,128}, {C, 44}, {L,220}, {C, 40}, {L,212}, {L,124}, }, // zidx = 140
        { {C,134}, {C,138}, {C,130}, {C, 46}, {L,222}, {C, 42}, {L,214}, {L,126}, }, // zidx = 142
        { {C, 56}, {C,132}, {C, 44}, {C, 48}, {C,128}, {C, 36}, {C, 40}, {C, 32}, }, // zidx = 144
        { {C, 58}, {C,134}, {C, 46}, {C, 50}, {C,130}, {C, 38}, {C, 42}, {C, 34}, }, // zidx = 146
        { {C, 60}, {C,144}, {C, 56}, {C, 52}, {C,132}, {C, 48}, {C, 44}, {C, 36}, }, // zidx = 148
        { {C, 62}, {C,146}, {C, 58}, {C, 54}, {C,134}, {C, 50}, {C, 46}, {C, 38}, }, // zidx = 150
        { {C,144}, {C,140}, {C,132}, {C, 56}, {C,136}, {C, 44}, {C,128}, {C, 40}, }, // zidx = 152
        { {C,146}, {C,142}, {C,134}, {C, 58}, {C,138}, {C, 46}, {C,130}, {C, 42}, }, // zidx = 154
        { {C,148}, {C,152}, {C,144}, {C, 60}, {C,140}, {C, 56}, {C,132}, {C, 44}, }, // zidx = 156
        { {C,150}, {C,154}, {C,146}, {C, 62}, {C,142}, {C, 58}, {C,134}, {C, 46}, }, // zidx = 158
        { {C,136}, {L,244}, {L,220}, {C,128}, {L,240}, {L,212}, {L,216}, {L,208}, }, // zidx = 160
        { {C,138}, {L,246}, {L,222}, {C,130}, {L,242}, {L,214}, {L,218}, {L,210}, }, // zidx = 162
        { {C,140}, {C,160}, {C,136}, {C,132}, {L,244}, {C,128}, {L,220}, {L,212}, }, // zidx = 164
        { {C,142}, {C,162}, {C,138}, {C,134}, {L,246}, {C,130}, {L,222}, {L,214}, }, // zidx = 166
        { {C,160}, {L,252}, {L,244}, {C,136}, {L,248}, {L,220}, {L,240}, {L,216}, }, // zidx = 168
        { {C,162}, {L,254}, {L,246}, {C,138}, {L,250}, {L,222}, {L,242}, {L,218}, }, // zidx = 170
        { {C,164}, {C,168}, {C,160}, {C,140}, {L,252}, {C,136}, {L,244}, {L,220}, }, // zidx = 172
        { {C,166}, {C,170}, {C,162}, {C,142}, {L,254}, {C,138}, {L,246}, {L,222}, }, // zidx = 174
        { {C,152}, {C,164}, {C,140}, {C,144}, {C,160}, {C,132}, {C,136}, {C,128}, }, // zidx = 176
        { {C,154}, {C,166}, {C,142}, {C,146}, {C,162}, {C,134}, {C,138}, {C,130}, }, // zidx = 178
        { {C,156}, {C,176}, {C,152}, {C,148}, {C,164}, {C,144}, {C,140}, {C,132}, }, // zidx = 180
        { {C,158}, {C,178}, {C,154}, {C,150}, {C,166}, {C,146}, {C,142}, {C,134}, }, // zidx = 182
        { {C,176}, {C,172}, {C,164}, {C,152}, {C,168}, {C,140}, {C,160}, {C,136}, }, // zidx = 184
        { {C,178}, {C,174}, {C,166}, {C,154}, {C,170}, {C,142}, {C,162}, {C,138}, }, // zidx = 186
        { {C,180}, {C,184}, {C,176}, {C,156}, {C,172}, {C,152}, {C,164}, {C,140}, }, // zidx = 188
        { {C,182}, {C,186}, {C,178}, {C,158}, {C,174}, {C,154}, {C,166}, {C,142}, }, // zidx = 190
        { {C,104}, {C,148}, {C, 60}, {C, 96}, {C,144}, {C, 52}, {C, 56}, {C, 48}, }, // zidx = 192
        { {C,106}, {C,150}, {C, 62}, {C, 98}, {C,146}, {C, 54}, {C, 58}, {C, 50}, }, // zidx = 194
        { {C,108}, {C,192}, {C,104}, {C,100}, {C,148}, {C, 96}, {C, 60}, {C, 52}, }, // zidx = 196
        { {C,110}, {C,194}, {C,106}, {C,102}, {C,150}, {C, 98}, {C, 62}, {C, 54}, }, // zidx = 198
        { {C,192}, {C,156}, {C,148}, {C,104}, {C,152}, {C, 60}, {C,144}, {C, 56}, }, // zidx = 200
        { {C,194}, {C,158}, {C,150}, {C,106}, {C,154}, {C, 62}, {C,146}, {C, 58}, }, // zidx = 202
        { {C,196}, {C,200}, {C,192}, {C,108}, {C,156}, {C,104}, {C,148}, {C, 60}, }, // zidx = 204
        { {C,198}, {C,202}, {C,194}, {C,110}, {C,158}, {C,106}, {C,150}, {C, 62}, }, // zidx = 206
        { {C,120}, {C,196}, {C,108}, {C,112}, {C,192}, {C,100}, {C,104}, {C, 96}, }, // zidx = 208
        { {C,122}, {C,198}, {C,110}, {C,114}, {C,194}, {C,102}, {C,106}, {C, 98}, }, // zidx = 210
        { {C,124}, {C,208}, {C,120}, {C,116}, {C,196}, {C,112}, {C,108}, {C,100}, }, // zidx = 212
        { {C,126}, {C,210}, {C,122}, {C,118}, {C,198}, {C,114}, {C,110}, {C,102}, }, // zidx = 214
        { {C,208}, {C,204}, {C,196}, {C,120}, {C,200}, {C,108}, {C,192}, {C,104}, }, // zidx = 216
        { {C,210}, {C,206}, {C,198}, {C,122}, {C,202}, {C,110}, {C,194}, {C,106}, }, // zidx = 218
        { {C,212}, {C,216}, {C,208}, {C,124}, {C,204}, {C,120}, {C,196}, {C,108}, }, // zidx = 220
        { {C,214}, {C,218}, {C,210}, {C,126}, {C,206}, {C,122}, {C,198}, {C,110}, }, // zidx = 222
        { {C,200}, {C,180}, {C,156}, {C,192}, {C,176}, {C,148}, {C,152}, {C,144}, }, // zidx = 224
        { {C,202}, {C,182}, {C,158}, {C,194}, {C,178}, {C,150}, {C,154}, {C,146}, }, // zidx = 226
        { {C,204}, {C,224}, {C,200}, {C,196}, {C,180}, {C,192}, {C,156}, {C,148}, }, // zidx = 228
        { {C,206}, {C,226}, {C,202}, {C,198}, {C,182}, {C,194}, {C,158}, {C,150}, }, // zidx = 230
        { {C,224}, {C,188}, {C,180}, {C,200}, {C,184}, {C,156}, {C,176}, {C,152}, }, // zidx = 232
        { {C,226}, {C,190}, {C,182}, {C,202}, {C,186}, {C,158}, {C,178}, {C,154}, }, // zidx = 234
        { {C,228}, {C,232}, {C,224}, {C,204}, {C,188}, {C,200}, {C,180}, {C,156}, }, // zidx = 236
        { {C,230}, {C,234}, {C,226}, {C,206}, {C,190}, {C,202}, {C,182}, {C,158}, }, // zidx = 238
        { {C,216}, {C,228}, {C,204}, {C,208}, {C,224}, {C,196}, {C,200}, {C,192}, }, // zidx = 240
        { {C,218}, {C,230}, {C,206}, {C,210}, {C,226}, {C,198}, {C,202}, {C,194}, }, // zidx = 242
        { {C,220}, {C,240}, {C,216}, {C,212}, {C,228}, {C,208}, {C,204}, {C,196}, }, // zidx = 244
        { {C,222}, {C,242}, {C,218}, {C,214}, {C,230}, {C,210}, {C,206}, {C,198}, }, // zidx = 246
        { {C,240}, {C,236}, {C,228}, {C,216}, {C,232}, {C,204}, {C,224}, {C,200}, }, // zidx = 248
        { {C,242}, {C,238}, {C,230}, {C,218}, {C,234}, {C,206}, {C,226}, {C,202}, }, // zidx = 250
        { {C,244}, {C,248}, {C,240}, {C,220}, {C,236}, {C,216}, {C,228}, {C,204}, }, // zidx = 252
        { {C,246}, {C,250}, {C,242}, {C,222}, {C,238}, {C,218}, {C,230}, {C,206}, }, // zidx = 254
    };

    const MvRefLoc mv_ref_locations_8x8[64][8] = {
        { {A,171}, {L, 87}, {D,255}, {A,163}, {L, 83}, {D,247}, {D,251}, {D,243}, }, // zidx = 0
        { {A,175}, {C,  3}, {A,171}, {A,167}, {L, 87}, {A,163}, {D,255}, {D,247}, }, // zidx = 4
        { {C,  3}, {L, 95}, {L, 87}, {A,171}, {L, 91}, {D,255}, {L, 83}, {D,251}, }, // zidx = 8
        { {C,  7}, {C, 11}, {C,  3}, {A,175}, {L, 95}, {A,171}, {L, 87}, {D,255}, }, // zidx = 12
        { {A,187}, {C,  7}, {A,175}, {A,179}, {C,  3}, {A,167}, {A,171}, {A,163}, }, // zidx = 16
        { {A,191}, {C, 19}, {A,187}, {A,183}, {C,  7}, {A,179}, {A,175}, {A,167}, }, // zidx = 20
        { {C, 19}, {C, 15}, {C,  7}, {A,187}, {C, 11}, {A,175}, {C,  3}, {A,171}, }, // zidx = 24
        { {C, 23}, {C, 27}, {C, 19}, {A,191}, {C, 15}, {A,187}, {C,  7}, {A,175}, }, // zidx = 28
        { {C, 11}, {L,119}, {L, 95}, {C,  3}, {L,115}, {L, 87}, {L, 91}, {L, 83}, }, // zidx = 32
        { {C, 15}, {C, 35}, {C, 11}, {C,  7}, {L,119}, {C,  3}, {L, 95}, {L, 87}, }, // zidx = 36
        { {C, 35}, {L,127}, {L,119}, {C, 11}, {L,123}, {L, 95}, {L,115}, {L, 91}, }, // zidx = 40
        { {C, 39}, {C, 43}, {C, 35}, {C, 15}, {L,127}, {C, 11}, {L,119}, {L, 95}, }, // zidx = 44
        { {C, 27}, {C, 39}, {C, 15}, {C, 19}, {C, 35}, {C,  7}, {C, 11}, {C,  3}, }, // zidx = 48
        { {C, 31}, {C, 51}, {C, 27}, {C, 23}, {C, 39}, {C, 19}, {C, 15}, {C,  7}, }, // zidx = 52
        { {C, 51}, {C, 47}, {C, 39}, {C, 27}, {C, 43}, {C, 15}, {C, 35}, {C, 11}, }, // zidx = 56
        { {C, 55}, {C, 59}, {C, 51}, {C, 31}, {C, 47}, {C, 27}, {C, 39}, {C, 15}, }, // zidx = 60
        { {A,235}, {C, 23}, {A,191}, {A,227}, {C, 19}, {A,183}, {A,187}, {A,179}, }, // zidx = 64
        { {A,239}, {C, 67}, {A,235}, {A,231}, {C, 23}, {A,227}, {A,191}, {A,183}, }, // zidx = 68
        { {C, 67}, {C, 31}, {C, 23}, {A,235}, {C, 27}, {A,191}, {C, 19}, {A,187}, }, // zidx = 72
        { {C, 71}, {C, 75}, {C, 67}, {A,239}, {C, 31}, {A,235}, {C, 23}, {A,191}, }, // zidx = 76
        { {A,251}, {C, 71}, {A,239}, {A,243}, {C, 67}, {A,231}, {A,235}, {A,227}, }, // zidx = 80
        { {A,255}, {C, 83}, {A,251}, {A,247}, {C, 71}, {A,243}, {A,239}, {A,231}, }, // zidx = 84
        { {C, 83}, {C, 79}, {C, 71}, {A,251}, {C, 75}, {A,239}, {C, 67}, {A,235}, }, // zidx = 88
        { {C, 87}, {C, 91}, {C, 83}, {A,255}, {C, 79}, {A,251}, {C, 71}, {A,239}, }, // zidx = 92
        { {C, 75}, {C, 55}, {C, 31}, {C, 67}, {C, 51}, {C, 23}, {C, 27}, {C, 19}, }, // zidx = 96
        { {C, 79}, {C, 99}, {C, 75}, {C, 71}, {C, 55}, {C, 67}, {C, 31}, {C, 23}, }, // zidx = 100
        { {C, 99}, {C, 63}, {C, 55}, {C, 75}, {C, 59}, {C, 31}, {C, 51}, {C, 27}, }, // zidx = 104
        { {C,103}, {C,107}, {C, 99}, {C, 79}, {C, 63}, {C, 75}, {C, 55}, {C, 31}, }, // zidx = 108
        { {C, 91}, {C,103}, {C, 79}, {C, 83}, {C, 99}, {C, 71}, {C, 75}, {C, 67}, }, // zidx = 112
        { {C, 95}, {C,115}, {C, 91}, {C, 87}, {C,103}, {C, 83}, {C, 79}, {C, 71}, }, // zidx = 116
        { {C,115}, {C,111}, {C,103}, {C, 91}, {C,107}, {C, 79}, {C, 99}, {C, 75}, }, // zidx = 120
        { {C,119}, {C,123}, {C,115}, {C, 95}, {C,111}, {C, 91}, {C,103}, {C, 79}, }, // zidx = 124
        { {C, 43}, {L,215}, {L,127}, {C, 35}, {L,211}, {L,119}, {L,123}, {L,115}, }, // zidx = 128
        { {C, 47}, {C,131}, {C, 43}, {C, 39}, {L,215}, {C, 35}, {L,127}, {L,119}, }, // zidx = 132
        { {C,131}, {L,223}, {L,215}, {C, 43}, {L,219}, {L,127}, {L,211}, {L,123}, }, // zidx = 136
        { {C,135}, {C,139}, {C,131}, {C, 47}, {L,223}, {C, 43}, {L,215}, {L,127}, }, // zidx = 140
        { {C, 59}, {C,135}, {C, 47}, {C, 51}, {C,131}, {C, 39}, {C, 43}, {C, 35}, }, // zidx = 144
        { {C, 63}, {C,147}, {C, 59}, {C, 55}, {C,135}, {C, 51}, {C, 47}, {C, 39}, }, // zidx = 148
        { {C,147}, {C,143}, {C,135}, {C, 59}, {C,139}, {C, 47}, {C,131}, {C, 43}, }, // zidx = 152
        { {C,151}, {C,155}, {C,147}, {C, 63}, {C,143}, {C, 59}, {C,135}, {C, 47}, }, // zidx = 156
        { {C,139}, {L,247}, {L,223}, {C,131}, {L,243}, {L,215}, {L,219}, {L,211}, }, // zidx = 160
        { {C,143}, {C,163}, {C,139}, {C,135}, {L,247}, {C,131}, {L,223}, {L,215}, }, // zidx = 164
        { {C,163}, {L,255}, {L,247}, {C,139}, {L,251}, {L,223}, {L,243}, {L,219}, }, // zidx = 168
        { {C,167}, {C,171}, {C,163}, {C,143}, {L,255}, {C,139}, {L,247}, {L,223}, }, // zidx = 172
        { {C,155}, {C,167}, {C,143}, {C,147}, {C,163}, {C,135}, {C,139}, {C,131}, }, // zidx = 176
        { {C,159}, {C,179}, {C,155}, {C,151}, {C,167}, {C,147}, {C,143}, {C,135}, }, // zidx = 180
        { {C,179}, {C,175}, {C,167}, {C,155}, {C,171}, {C,143}, {C,163}, {C,139}, }, // zidx = 184
        { {C,183}, {C,187}, {C,179}, {C,159}, {C,175}, {C,155}, {C,167}, {C,143}, }, // zidx = 188
        { {C,107}, {C,151}, {C, 63}, {C, 99}, {C,147}, {C, 55}, {C, 59}, {C, 51}, }, // zidx = 192
        { {C,111}, {C,195}, {C,107}, {C,103}, {C,151}, {C, 99}, {C, 63}, {C, 55}, }, // zidx = 196
        { {C,195}, {C,159}, {C,151}, {C,107}, {C,155}, {C, 63}, {C,147}, {C, 59}, }, // zidx = 200
        { {C,199}, {C,203}, {C,195}, {C,111}, {C,159}, {C,107}, {C,151}, {C, 63}, }, // zidx = 204
        { {C,123}, {C,199}, {C,111}, {C,115}, {C,195}, {C,103}, {C,107}, {C, 99}, }, // zidx = 208
        { {C,127}, {C,211}, {C,123}, {C,119}, {C,199}, {C,115}, {C,111}, {C,103}, }, // zidx = 212
        { {C,211}, {C,207}, {C,199}, {C,123}, {C,203}, {C,111}, {C,195}, {C,107}, }, // zidx = 216
        { {C,215}, {C,219}, {C,211}, {C,127}, {C,207}, {C,123}, {C,199}, {C,111}, }, // zidx = 220
        { {C,203}, {C,183}, {C,159}, {C,195}, {C,179}, {C,151}, {C,155}, {C,147}, }, // zidx = 224
        { {C,207}, {C,227}, {C,203}, {C,199}, {C,183}, {C,195}, {C,159}, {C,151}, }, // zidx = 228
        { {C,227}, {C,191}, {C,183}, {C,203}, {C,187}, {C,159}, {C,179}, {C,155}, }, // zidx = 232
        { {C,231}, {C,235}, {C,227}, {C,207}, {C,191}, {C,203}, {C,183}, {C,159}, }, // zidx = 236
        { {C,219}, {C,231}, {C,207}, {C,211}, {C,227}, {C,199}, {C,203}, {C,195}, }, // zidx = 240
        { {C,223}, {C,243}, {C,219}, {C,215}, {C,231}, {C,211}, {C,207}, {C,199}, }, // zidx = 244
        { {C,243}, {C,239}, {C,231}, {C,219}, {C,235}, {C,207}, {C,227}, {C,203}, }, // zidx = 248
        { {C,247}, {C,251}, {C,243}, {C,223}, {C,239}, {C,219}, {C,231}, {C,207}, }, // zidx = 252
    };

    const MvRefLoc mv_ref_locations_8x16[32][8] = {
        { {L, 87}, {A,171}, {L, 95}, {D,255}, {L, 83}, {A,163}, {D,247}, {D,251}, }, // zidx = 0
        { {C,  3}, {A,175}, {C, 11}, {A,171}, {L, 87}, {A,167}, {A,163}, {D,255}, }, // zidx = 4
        { {C,  7}, {A,187}, {C, 15}, {A,175}, {C,  3}, {A,179}, {A,167}, {A,171}, }, // zidx = 16
        { {C, 19}, {A,191}, {C, 27}, {A,187}, {C,  7}, {A,183}, {A,179}, {A,175}, }, // zidx = 20
        { {L,119}, {C, 11}, {L,127}, {L, 95}, {L,115}, {C,  3}, {L, 87}, {L, 91}, }, // zidx = 32
        { {C, 35}, {C, 15}, {C, 43}, {C, 11}, {L,119}, {C,  7}, {C,  3}, {L, 95}, }, // zidx = 36
        { {C, 39}, {C, 27}, {C, 47}, {C, 15}, {C, 35}, {C, 19}, {C,  7}, {C, 11}, }, // zidx = 48
        { {C, 51}, {C, 31}, {C, 59}, {C, 27}, {C, 39}, {C, 23}, {C, 19}, {C, 15}, }, // zidx = 52
        { {C, 23}, {A,235}, {C, 31}, {A,191}, {C, 19}, {A,227}, {A,183}, {A,187}, }, // zidx = 64
        { {C, 67}, {A,239}, {C, 75}, {A,235}, {C, 23}, {A,231}, {A,227}, {A,191}, }, // zidx = 68
        { {C, 71}, {A,251}, {C, 79}, {A,239}, {C, 67}, {A,243}, {A,231}, {A,235}, }, // zidx = 80
        { {C, 83}, {A,255}, {C, 91}, {A,251}, {C, 71}, {A,247}, {A,243}, {A,239}, }, // zidx = 84
        { {C, 55}, {C, 75}, {C, 63}, {C, 31}, {C, 51}, {C, 67}, {C, 23}, {C, 27}, }, // zidx = 96
        { {C, 99}, {C, 79}, {C,107}, {C, 75}, {C, 55}, {C, 71}, {C, 67}, {C, 31}, }, // zidx = 100
        { {C,103}, {C, 91}, {C,111}, {C, 79}, {C, 99}, {C, 83}, {C, 71}, {C, 75}, }, // zidx = 112
        { {C,115}, {C, 95}, {C,123}, {C, 91}, {C,103}, {C, 87}, {C, 83}, {C, 79}, }, // zidx = 116
        { {L,215}, {C, 43}, {L,223}, {L,127}, {L,211}, {C, 35}, {L,119}, {L,123}, }, // zidx = 128
        { {C,131}, {C, 47}, {C,139}, {C, 43}, {L,215}, {C, 39}, {C, 35}, {L,127}, }, // zidx = 132
        { {C,135}, {C, 59}, {C,143}, {C, 47}, {C,131}, {C, 51}, {C, 39}, {C, 43}, }, // zidx = 144
        { {C,147}, {C, 63}, {C,155}, {C, 59}, {C,135}, {C, 55}, {C, 51}, {C, 47}, }, // zidx = 148
        { {L,247}, {C,139}, {L,255}, {L,223}, {L,243}, {C,131}, {L,215}, {L,219}, }, // zidx = 160
        { {C,163}, {C,143}, {C,171}, {C,139}, {L,247}, {C,135}, {C,131}, {L,223}, }, // zidx = 164
        { {C,167}, {C,155}, {C,175}, {C,143}, {C,163}, {C,147}, {C,135}, {C,139}, }, // zidx = 176
        { {C,179}, {C,159}, {C,187}, {C,155}, {C,167}, {C,151}, {C,147}, {C,143}, }, // zidx = 180
        { {C,151}, {C,107}, {C,159}, {C, 63}, {C,147}, {C, 99}, {C, 55}, {C, 59}, }, // zidx = 192
        { {C,195}, {C,111}, {C,203}, {C,107}, {C,151}, {C,103}, {C, 99}, {C, 63}, }, // zidx = 196
        { {C,199}, {C,123}, {C,207}, {C,111}, {C,195}, {C,115}, {C,103}, {C,107}, }, // zidx = 208
        { {C,211}, {C,127}, {C,219}, {C,123}, {C,199}, {C,119}, {C,115}, {C,111}, }, // zidx = 212
        { {C,183}, {C,203}, {C,191}, {C,159}, {C,179}, {C,195}, {C,151}, {C,155}, }, // zidx = 224
        { {C,227}, {C,207}, {C,235}, {C,203}, {C,183}, {C,199}, {C,195}, {C,159}, }, // zidx = 228
        { {C,231}, {C,219}, {C,239}, {C,207}, {C,227}, {C,211}, {C,199}, {C,203}, }, // zidx = 240
        { {C,243}, {C,223}, {C,251}, {C,219}, {C,231}, {C,215}, {C,211}, {C,207}, }, // zidx = 244
    };

    const MvRefLoc mv_ref_locations_16x8[32][8] = {
        { {A,171}, {L, 87}, {A,175}, {D,255}, {A,163}, {L, 83}, {D,251}, {D,247}, }, // zidx = 0
        { {C,  3}, {L, 95}, {C,  7}, {L, 87}, {A,171}, {L, 91}, {L, 83}, {D,255}, }, // zidx = 8
        { {A,187}, {C,  7}, {A,191}, {A,175}, {A,179}, {C,  3}, {A,171}, {A,167}, }, // zidx = 16
        { {C, 19}, {C, 15}, {C, 23}, {C,  7}, {A,187}, {C, 11}, {C,  3}, {A,175}, }, // zidx = 24
        { {C, 11}, {L,119}, {C, 15}, {L, 95}, {C,  3}, {L,115}, {L, 91}, {L, 87}, }, // zidx = 32
        { {C, 35}, {L,127}, {C, 39}, {L,119}, {C, 11}, {L,123}, {L,115}, {L, 95}, }, // zidx = 40
        { {C, 27}, {C, 39}, {C, 31}, {C, 15}, {C, 19}, {C, 35}, {C, 11}, {C,  7}, }, // zidx = 48
        { {C, 51}, {C, 47}, {C, 55}, {C, 39}, {C, 27}, {C, 43}, {C, 35}, {C, 15}, }, // zidx = 56
        { {A,235}, {C, 23}, {A,239}, {A,191}, {A,227}, {C, 19}, {A,187}, {A,183}, }, // zidx = 64
        { {C, 67}, {C, 31}, {C, 71}, {C, 23}, {A,235}, {C, 27}, {C, 19}, {A,191}, }, // zidx = 72
        { {A,251}, {C, 71}, {A,255}, {A,239}, {A,243}, {C, 67}, {A,235}, {A,231}, }, // zidx = 80
        { {C, 83}, {C, 79}, {C, 87}, {C, 71}, {A,251}, {C, 75}, {C, 67}, {A,239}, }, // zidx = 88
        { {C, 75}, {C, 55}, {C, 79}, {C, 31}, {C, 67}, {C, 51}, {C, 27}, {C, 23}, }, // zidx = 96
        { {C, 99}, {C, 63}, {C,103}, {C, 55}, {C, 75}, {C, 59}, {C, 51}, {C, 31}, }, // zidx = 104
        { {C, 91}, {C,103}, {C, 95}, {C, 79}, {C, 83}, {C, 99}, {C, 75}, {C, 71}, }, // zidx = 112
        { {C,115}, {C,111}, {C,119}, {C,103}, {C, 91}, {C,107}, {C, 99}, {C, 79}, }, // zidx = 120
        { {C, 43}, {L,215}, {C, 47}, {L,127}, {C, 35}, {L,211}, {L,123}, {L,119}, }, // zidx = 128
        { {C,131}, {L,223}, {C,135}, {L,215}, {C, 43}, {L,219}, {L,211}, {L,127}, }, // zidx = 136
        { {C, 59}, {C,135}, {C, 63}, {C, 47}, {C, 51}, {C,131}, {C, 43}, {C, 39}, }, // zidx = 144
        { {C,147}, {C,143}, {C,151}, {C,135}, {C, 59}, {C,139}, {C,131}, {C, 47}, }, // zidx = 152
        { {C,139}, {L,247}, {C,143}, {L,223}, {C,131}, {L,243}, {L,219}, {L,215}, }, // zidx = 160
        { {C,163}, {L,255}, {C,167}, {L,247}, {C,139}, {L,251}, {L,243}, {L,223}, }, // zidx = 168
        { {C,155}, {C,167}, {C,159}, {C,143}, {C,147}, {C,163}, {C,139}, {C,135}, }, // zidx = 176
        { {C,179}, {C,175}, {C,183}, {C,167}, {C,155}, {C,171}, {C,163}, {C,143}, }, // zidx = 184
        { {C,107}, {C,151}, {C,111}, {C, 63}, {C, 99}, {C,147}, {C, 59}, {C, 55}, }, // zidx = 192
        { {C,195}, {C,159}, {C,199}, {C,151}, {C,107}, {C,155}, {C,147}, {C, 63}, }, // zidx = 200
        { {C,123}, {C,199}, {C,127}, {C,111}, {C,115}, {C,195}, {C,107}, {C,103}, }, // zidx = 208
        { {C,211}, {C,207}, {C,215}, {C,199}, {C,123}, {C,203}, {C,195}, {C,111}, }, // zidx = 216
        { {C,203}, {C,183}, {C,207}, {C,159}, {C,195}, {C,179}, {C,155}, {C,151}, }, // zidx = 224
        { {C,227}, {C,191}, {C,231}, {C,183}, {C,203}, {C,187}, {C,179}, {C,159}, }, // zidx = 232
        { {C,219}, {C,231}, {C,223}, {C,207}, {C,211}, {C,227}, {C,203}, {C,199}, }, // zidx = 240
        { {C,243}, {C,239}, {C,247}, {C,231}, {C,219}, {C,235}, {C,227}, {C,207}, }, // zidx = 248
    };

    const MvRefLoc mv_ref_locations_16x16[16][8] = {
        { {A,171}, {L, 87}, {A,175}, {L, 95}, {D,255}, {A,139}, {L, 71}, {D,207}, }, // zidx = 0
        { {A,187}, {C,  7}, {A,191}, {C, 15}, {A,175}, {A,155}, {L, 87}, {D,223}, }, // zidx = 16
        { {C, 11}, {L,119}, {C, 15}, {L,127}, {L, 95}, {A,171}, {L,103}, {D,239}, }, // zidx = 32
        { {C, 27}, {C, 39}, {C, 31}, {C, 47}, {C, 15}, {A,187}, {L,119}, {D,255}, }, // zidx = 48
        { {A,235}, {C, 23}, {A,239}, {C, 31}, {A,191}, {A,203}, {C,  7}, {A,143}, }, // zidx = 64
        { {A,251}, {C, 71}, {A,255}, {C, 79}, {A,239}, {A,219}, {C, 23}, {A,159}, }, // zidx = 80
        { {C, 75}, {C, 55}, {C, 79}, {C, 63}, {C, 31}, {A,235}, {C, 39}, {A,175}, }, // zidx = 96
        { {C, 91}, {C,103}, {C, 95}, {C,111}, {C, 79}, {A,251}, {C, 55}, {A,191}, }, // zidx = 112
        { {C, 43}, {L,215}, {C, 47}, {L,223}, {L,127}, {C, 11}, {L,199}, {L, 79}, }, // zidx = 128
        { {C, 59}, {C,135}, {C, 63}, {C,143}, {C, 47}, {C, 27}, {L,215}, {L, 95}, }, // zidx = 144
        { {C,139}, {L,247}, {C,143}, {L,255}, {L,223}, {C, 43}, {L,231}, {L,111}, }, // zidx = 160
        { {C,155}, {C,167}, {C,159}, {C,175}, {C,143}, {C, 59}, {L,247}, {L,127}, }, // zidx = 176
        { {C,107}, {C,151}, {C,111}, {C,159}, {C, 63}, {C, 75}, {C,135}, {C, 15}, }, // zidx = 192
        { {C,123}, {C,199}, {C,127}, {C,207}, {C,111}, {C, 91}, {C,151}, {C, 31}, }, // zidx = 208
        { {C,203}, {C,183}, {C,207}, {C,191}, {C,159}, {C,107}, {C,167}, {C, 47}, }, // zidx = 224
        { {C,219}, {C,231}, {C,223}, {C,239}, {C,207}, {C,123}, {C,183}, {C, 63}, }, // zidx = 240
    };

    const MvRefLoc mv_ref_locations_16x32[8][8] = {
        { {L, 87}, {A,171}, {L,119}, {D,255}, {A,175}, {L, 71}, {A,139}, {D,207}, }, // zidx = 0
        { {C,  7}, {A,187}, {C, 39}, {A,175}, {A,191}, {L, 87}, {A,155}, {D,223}, }, // zidx = 16
        { {C, 23}, {A,235}, {C, 55}, {A,191}, {A,239}, {C,  7}, {A,203}, {A,143}, }, // zidx = 64
        { {C, 71}, {A,251}, {C,103}, {A,239}, {A,255}, {C, 23}, {A,219}, {A,159}, }, // zidx = 80
        { {L,215}, {C, 43}, {L,247}, {L,127}, {C, 47}, {L,199}, {C, 11}, {L, 79}, }, // zidx = 128
        { {C,135}, {C, 59}, {C,167}, {C, 47}, {C, 63}, {L,215}, {C, 27}, {L, 95}, }, // zidx = 144
        { {C,151}, {C,107}, {C,183}, {C, 63}, {C,111}, {C,135}, {C, 75}, {C, 15}, }, // zidx = 192
        { {C,199}, {C,123}, {C,231}, {C,111}, {C,127}, {C,151}, {C, 91}, {C, 31}, }, // zidx = 208
    };

    const MvRefLoc mv_ref_locations_32x16[8][8] = {
        { {A,171}, {L, 87}, {A,187}, {D,255}, {L, 95}, {A,139}, {L, 71}, {D,207}, }, // zidx = 0
        { {C, 11}, {L,119}, {C, 27}, {L, 95}, {L,127}, {A,171}, {L,103}, {D,239}, }, // zidx = 32
        { {A,235}, {C, 23}, {A,251}, {A,191}, {C, 31}, {A,203}, {C,  7}, {A,143}, }, // zidx = 64
        { {C, 75}, {C, 55}, {C, 91}, {C, 31}, {C, 63}, {A,235}, {C, 39}, {A,175}, }, // zidx = 96
        { {C, 43}, {L,215}, {C, 59}, {L,127}, {L,223}, {C, 11}, {L,199}, {L, 79}, }, // zidx = 128
        { {C,139}, {L,247}, {C,155}, {L,223}, {L,255}, {C, 43}, {L,231}, {L,111}, }, // zidx = 160
        { {C,107}, {C,151}, {C,123}, {C, 63}, {C,159}, {C, 75}, {C,135}, {C, 15}, }, // zidx = 192
        { {C,203}, {C,183}, {C,219}, {C,159}, {C,191}, {C,107}, {C,167}, {C, 47}, }, // zidx = 224
    };

    const MvRefLoc mv_ref_locations_32x32[4][8] = {
        { {A,175}, {L, 95}, {A,187}, {L,119}, {D,255}, {A,139}, {L, 71}, {D,207}, }, // zidx = 0
        { {A,239}, {C, 31}, {A,251}, {C, 55}, {A,191}, {A,203}, {C,  7}, {A,143}, }, // zidx = 64
        { {C, 47}, {L,223}, {C, 59}, {L,247}, {L,127}, {C, 11}, {L,199}, {L, 79}, }, // zidx = 128
        { {C,111}, {C,159}, {C,123}, {C,183}, {C, 63}, {C, 75}, {C,135}, {C, 15}, }, // zidx = 192
    };

    const MvRefLoc mv_ref_locations_32x64[2][8] = {
        { {L, 87}, {A,171}, {L,215}, {A,187}, {D,255}, {L, 71}, {A,139}, {L,119}, }, // zidx = 0
        { {C, 23}, {A,235}, {C,151}, {A,251}, {A,191}, {C,  7}, {A,203}, {C, 55}, }, // zidx = 64
    };

    const MvRefLoc mv_ref_locations_64x32[2][8] = {
        { {A,171}, {L, 87}, {A,235}, {L,119}, {D,255}, {A,139}, {L, 71}, {A,187}, }, // zidx = 0
        { {C, 43}, {L,215}, {C,107}, {L,247}, {L,127}, {C, 11}, {L,199}, {C, 59}, }, // zidx = 128
    };

    const MvRefLoc mv_ref_locations_64x64[1][8] = {
        { {A,191}, {L,127}, {A,235}, {L,215}, {D,255}, {A,171}, {L, 87}, {A,251}, }, // zidx = 0
    };

    const MvRefLoc (*mv_ref_locations[BLOCK_SIZES])[8] = {
        mv_ref_locations_4x4,
        mv_ref_locations_4x8,
        mv_ref_locations_8x4,
        mv_ref_locations_8x8,
        mv_ref_locations_8x16,
        mv_ref_locations_16x8,
        mv_ref_locations_16x16,
        mv_ref_locations_16x32,mv_ref_locations_32x16,
        mv_ref_locations_32x32,
        mv_ref_locations_32x64,
        mv_ref_locations_64x32,
        mv_ref_locations_64x64,
    };


    alignas(32) const InterpKernel bilinear_filters[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },  { 0, 0, 0, 120, 8, 0, 0, 0 },
        { 0, 0, 0, 112, 16, 0, 0, 0 }, { 0, 0, 0, 104, 24, 0, 0, 0 },
        { 0, 0, 0, 96, 32, 0, 0, 0 },  { 0, 0, 0, 88, 40, 0, 0, 0 },
        { 0, 0, 0, 80, 48, 0, 0, 0 },  { 0, 0, 0, 72, 56, 0, 0, 0 },
        { 0, 0, 0, 64, 64, 0, 0, 0 },  { 0, 0, 0, 56, 72, 0, 0, 0 },
        { 0, 0, 0, 48, 80, 0, 0, 0 },  { 0, 0, 0, 40, 88, 0, 0, 0 },
        { 0, 0, 0, 32, 96, 0, 0, 0 },  { 0, 0, 0, 24, 104, 0, 0, 0 },
        { 0, 0, 0, 16, 112, 0, 0, 0 }, { 0, 0, 0, 8, 120, 0, 0, 0 }
    };

    // Lagrangian interpolation filter
    alignas(32) const InterpKernel sub_pel_filters_8[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },        { 0, 1, -5, 126, 8, -3, 1, 0 },
        { -1, 3, -10, 122, 18, -6, 2, 0 },   { -1, 4, -13, 118, 27, -9, 3, -1 },
        { -1, 4, -16, 112, 37, -11, 4, -1 }, { -1, 5, -18, 105, 48, -14, 4, -1 },
        { -1, 5, -19, 97, 58, -16, 5, -1 },  { -1, 6, -19, 88, 68, -18, 5, -1 },
        { -1, 6, -19, 78, 78, -19, 6, -1 },  { -1, 5, -18, 68, 88, -19, 6, -1 },
        { -1, 5, -16, 58, 97, -19, 5, -1 },  { -1, 4, -14, 48, 105, -18, 5, -1 },
        { -1, 4, -11, 37, 112, -16, 4, -1 }, { -1, 3, -9, 27, 118, -13, 4, -1 },
        { 0, 2, -6, 18, 122, -10, 3, -1 },   { 0, 1, -3, 8, 126, -5, 1, 0 }
    };
    alignas(32) const InterpKernel av1_sub_pel_filters_8[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },      { 0, 2, -6, 126, 8, -2, 0, 0 },
        { 0, 2, -10, 122, 18, -4, 0, 0 },  { 0, 2, -12, 116, 28, -8, 2, 0 },
        { 0, 2, -14, 110, 38, -10, 2, 0 }, { 0, 2, -14, 102, 48, -12, 2, 0 },
        { 0, 2, -16, 94, 58, -12, 2, 0 },  { 0, 2, -14, 84, 66, -12, 2, 0 },
        { 0, 2, -14, 76, 76, -14, 2, 0 },  { 0, 2, -12, 66, 84, -14, 2, 0 },
        { 0, 2, -12, 58, 94, -16, 2, 0 },  { 0, 2, -12, 48, 102, -14, 2, 0 },
        { 0, 2, -10, 38, 110, -14, 2, 0 }, { 0, 2, -8, 28, 116, -12, 2, 0 },
        { 0, 0, -4, 18, 122, -10, 2, 0 },  { 0, 0, -2, 8, 126, -6, 2, 0 }
    };

    // DCT based filter
    alignas(32) const InterpKernel sub_pel_filters_8s[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },         { -1, 3, -7, 127, 8, -3, 1, 0 },
        { -2, 5, -13, 125, 17, -6, 3, -1 },   { -3, 7, -17, 121, 27, -10, 5, -2 },
        { -4, 9, -20, 115, 37, -13, 6, -2 },  { -4, 10, -23, 108, 48, -16, 8, -3 },
        { -4, 10, -24, 100, 59, -19, 9, -3 }, { -4, 11, -24, 90, 70, -21, 10, -4 },
        { -4, 11, -23, 80, 80, -23, 11, -4 }, { -4, 10, -21, 70, 90, -24, 11, -4 },
        { -3, 9, -19, 59, 100, -24, 10, -4 }, { -3, 8, -16, 48, 108, -23, 10, -4 },
        { -2, 6, -13, 37, 115, -20, 9, -4 },  { -2, 5, -10, 27, 121, -17, 7, -3 },
        { -1, 3, -6, 17, 125, -13, 5, -2 },   { 0, 1, -3, 8, 127, -7, 3, -1 }
    };
    alignas(32) const InterpKernel av1_sub_pel_filters_8sharp[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },         { -2, 2, -6, 126, 8, -2, 2, 0 },
        { -2, 6, -12, 124, 16, -6, 4, -2 },   { -2, 8, -18, 120, 26, -10, 6, -2 },
        { -4, 10, -22, 116, 38, -14, 6, -2 }, { -4, 10, -22, 108, 48, -18, 8, -2 },
        { -4, 10, -24, 100, 60, -20, 8, -2 }, { -4, 10, -24, 90, 70, -22, 10, -2 },
        { -4, 12, -24, 80, 80, -24, 12, -4 }, { -2, 10, -22, 70, 90, -24, 10, -4 },
        { -2, 8, -20, 60, 100, -24, 10, -4 }, { -2, 8, -18, 48, 108, -22, 10, -4 },
        { -2, 6, -14, 38, 116, -22, 10, -4 }, { -2, 6, -10, 26, 120, -18, 8, -2 },
        { -2, 4, -6, 16, 124, -12, 6, -2 },   { 0, 2, -2, 8, 126, -6, 2, -2 }
    };

    // freqmultiplier = 0.5
    alignas(32) const InterpKernel sub_pel_filters_8lp[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },       { -3, -1, 32, 64, 38, 1, -3, 0 },
        { -2, -2, 29, 63, 41, 2, -3, 0 },   { -2, -2, 26, 63, 43, 4, -4, 0 },
        { -2, -3, 24, 62, 46, 5, -4, 0 },   { -2, -3, 21, 60, 49, 7, -4, 0 },
        { -1, -4, 18, 59, 51, 9, -4, 0 },   { -1, -4, 16, 57, 53, 12, -4, -1 },
        { -1, -4, 14, 55, 55, 14, -4, -1 }, { -1, -4, 12, 53, 57, 16, -4, -1 },
        { 0, -4, 9, 51, 59, 18, -4, -1 },   { 0, -4, 7, 49, 60, 21, -3, -2 },
        { 0, -4, 5, 46, 62, 24, -3, -2 },   { 0, -4, 4, 43, 63, 26, -2, -2 },
        { 0, -3, 2, 41, 63, 29, -2, -2 },   { 0, -3, 1, 38, 64, 32, -1, -3 }
    };
    alignas(32) const InterpKernel av1_sub_pel_filters_8smooth[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },     { 0, 2, 28, 62, 34, 2, 0, 0 },
        { 0, 0, 26, 62, 36, 4, 0, 0 },    { 0, 0, 22, 62, 40, 4, 0, 0 },
        { 0, 0, 20, 60, 42, 6, 0, 0 },    { 0, 0, 18, 58, 44, 8, 0, 0 },
        { 0, 0, 16, 56, 46, 10, 0, 0 },   { 0, -2, 16, 54, 48, 12, 0, 0 },
        { 0, -2, 14, 52, 52, 14, -2, 0 }, { 0, 0, 12, 48, 54, 16, -2, 0 },
        { 0, 0, 10, 46, 56, 16, 0, 0 },   { 0, 0, 8, 44, 58, 18, 0, 0 },
        { 0, 0, 6, 42, 60, 20, 0, 0 },    { 0, 0, 4, 40, 62, 22, 0, 0 },
        { 0, 0, 4, 36, 62, 26, 0, 0 },    { 0, 0, 2, 34, 62, 28, 2, 0 }
    };

    alignas(32) const InterpKernel av1_sub_pel_filters_4[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },     { 0, 0, -4, 126, 8, -2, 0, 0 },
        { 0, 0, -8, 122, 18, -4, 0, 0 },  { 0, 0, -10, 116, 28, -6, 0, 0 },
        { 0, 0, -12, 110, 38, -8, 0, 0 }, { 0, 0, -12, 102, 48, -10, 0, 0 },
        { 0, 0, -14, 94, 58, -10, 0, 0 }, { 0, 0, -12, 84, 66, -10, 0, 0 },
        { 0, 0, -12, 76, 76, -12, 0, 0 }, { 0, 0, -10, 66, 84, -12, 0, 0 },
        { 0, 0, -10, 58, 94, -14, 0, 0 }, { 0, 0, -10, 48, 102, -12, 0, 0 },
        { 0, 0, -8, 38, 110, -12, 0, 0 }, { 0, 0, -6, 28, 116, -10, 0, 0 },
        { 0, 0, -4, 18, 122, -8, 0, 0 },  { 0, 0, -2, 8, 126, -4, 0, 0 }
    };
    alignas(32) const InterpKernel av1_sub_pel_filters_4smooth[SUBPEL_SHIFTS] = {
        { 0, 0, 0, 128, 0, 0, 0, 0 },   { 0, 0, 30, 62, 34, 2, 0, 0 },
        { 0, 0, 26, 62, 36, 4, 0, 0 },  { 0, 0, 22, 62, 40, 4, 0, 0 },
        { 0, 0, 20, 60, 42, 6, 0, 0 },  { 0, 0, 18, 58, 44, 8, 0, 0 },
        { 0, 0, 16, 56, 46, 10, 0, 0 }, { 0, 0, 14, 54, 48, 12, 0, 0 },
        { 0, 0, 12, 52, 52, 12, 0, 0 }, { 0, 0, 12, 48, 54, 14, 0, 0 },
        { 0, 0, 10, 46, 56, 16, 0, 0 }, { 0, 0, 8, 44, 58, 18, 0, 0 },
        { 0, 0, 6, 42, 60, 20, 0, 0 },  { 0, 0, 4, 40, 62, 22, 0, 0 },
        { 0, 0, 4, 36, 62, 26, 0, 0 },  { 0, 0, 2, 34, 62, 30, 0, 0 }
    };

    const InterpKernel *vp9_filter_kernels[4] = {
        sub_pel_filters_8, sub_pel_filters_8lp, sub_pel_filters_8s, bilinear_filters,
    };

    const InterpKernel *av1_filter_kernels[4] = {
        av1_sub_pel_filters_8, av1_sub_pel_filters_8smooth, av1_sub_pel_filters_8sharp, bilinear_filters
    };

    const InterpKernel *av1_short_filter_kernels[4] = {
        av1_sub_pel_filters_4, av1_sub_pel_filters_4smooth, av1_sub_pel_filters_4, bilinear_filters
    };

    const TxSize txsize_sqr_map[TX_SIZES_ALL] = {
        TX_4X4,    // TX_4X4
        TX_8X8,    // TX_8X8
        TX_16X16,  // TX_16X16
        TX_32X32,  // TX_32X32
        TX_4X4,    // TX_4X8
        TX_4X4,    // TX_8X4
        TX_8X8,    // TX_8X16
        TX_8X8,    // TX_16X8
        TX_16X16,  // TX_16X32
        TX_16X16,  // TX_32X16
        TX_4X4,    // TX_4X16
        TX_4X4,    // TX_16X4
        TX_8X8,    // TX_8X32
        TX_8X8,    // TX_32X8
    };

    const TxSize txsize_sqr_up_map[TX_SIZES_ALL] = {
        TX_4X4,    // TX_4X4
        TX_8X8,    // TX_8X8
        TX_16X16,  // TX_16X16
        TX_32X32,  // TX_32X32
        TX_8X8,    // TX_4X8
        TX_8X8,    // TX_8X4
        TX_16X16,  // TX_8X16
        TX_16X16,  // TX_16X8
        TX_32X32,  // TX_16X32
        TX_32X32,  // TX_32X16
        TX_16X16,  // TX_4X16
        TX_16X16,  // TX_16X4
        TX_32X32,  // TX_8X32
        TX_32X32,  // TX_32X8
    };

    const uint8_t txsize_log2_minus4[TX_SIZES_ALL] = {
        0,  // TX_4X4
        2,  // TX_8X8
        4,  // TX_16X16
        6,  // TX_32X32
        6,  // TX_64X64
        1,  // TX_4X8
        1,  // TX_8X4
        3,  // TX_8X16
        3,  // TX_16X8
        5,  // TX_16X32
        5,  // TX_32X16
        6,  // TX_32X64
        6,  // TX_64X32
        2,  // TX_4X16
        2,  // TX_16X4
        4,  // TX_8X32
        4,  // TX_32X8
        5,  // TX_16X64
        5,  // TX_64X16
    };

    const TxClass tx_type_to_class[TX_TYPES] = {
        TX_CLASS_2D,     // DCT_DCT
        TX_CLASS_2D,     // ADST_DCT
        TX_CLASS_2D,     // DCT_ADST
        TX_CLASS_2D,     // ADST_ADST
        TX_CLASS_2D,     // FLIPADST_DCT
        TX_CLASS_2D,     // DCT_FLIPADST
        TX_CLASS_2D,     // FLIPADST_FLIPADST
        TX_CLASS_2D,     // ADST_FLIPADST
        TX_CLASS_2D,     // FLIPADST_ADST
        TX_CLASS_2D,     // IDTX
        TX_CLASS_VERT,   // V_DCT
        TX_CLASS_HORIZ,  // H_DCT
        TX_CLASS_VERT,   // V_ADST
        TX_CLASS_HORIZ,  // H_ADST
        TX_CLASS_VERT,   // V_FLIPADST
        TX_CLASS_HORIZ,  // H_FLIPADST
    };

    // Number of transform types in each set type
    const int32_t av1_num_ext_tx_set[EXT_TX_SET_TYPES] = {
        1, 2, 5, 7, 7, 10, 12, 16, 16,
    };

    // Number of transform types in each set type
    const int32_t num_ext_tx_set[EXT_TX_SET_TYPES] = { 1, 2, 5, 7, 7, 10, 12, 16, 16 };

    const int32_t av1_ext_tx_used[EXT_TX_SET_TYPES][TX_TYPES] = {
        { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 },
        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 },
    };

    const int32_t av1_ext_tx_ind[EXT_TX_SET_TYPES][TX_TYPES] = {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 3, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 5, 6, 4, 0, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0 },
        { 1, 5, 6, 4, 0, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0 },
        { 1, 2, 3, 6, 4, 5, 7, 8, 9, 0, 0, 0, 0, 0, 0, 0 },
        { 3, 4, 5, 8, 6, 7, 9, 10, 11, 0, 1, 2, 0, 0, 0, 0 },
        { 7, 8, 9, 12, 10, 11, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6 },
        { 7, 8, 9, 12, 10, 11, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6 },
    };

    const uint8_t hasTopRight[8][8] = {
        { 1, 1, 1, 1, 1, 1, 1, 1 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 1, 1, 0, 1, 1, 1, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 1, 1, 1, 1, 1, 1, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 1, 1, 0, 1, 1, 1, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 }
    };

    const uint8_t hasBelowLeft[8][8] = {
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 0, 0, 0, 1, 0, 0, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 1, 0, 0, 0, 1, 0, 0, 0 },
        { 1, 0, 1, 0, 1, 0, 1, 0 },
        { 0, 0, 0, 0, 0, 0, 0, 0 }
    };

    const BlockSize subsize_lookup[EXT_PARTITION_TYPES][BLOCK_SIZES_ALL] = {
        { // PARTITION_NONE
            //                            4X4
                                          BLOCK_4X4,
            // 4X8,        8X4,           8X8
            BLOCK_4X8,     BLOCK_8X4,     BLOCK_8X8,
            // 8X16,       16X8,          16X16
            BLOCK_8X16,    BLOCK_16X8,    BLOCK_16X16,
            // 16X32,      32X16,         32X32
            BLOCK_16X32,   BLOCK_32X16,   BLOCK_32X32,
            // 32X64,      64X32,         64X64
            BLOCK_32X64,   BLOCK_64X32,   BLOCK_64X64,
            // 64x128,     128x64,        128x128
            BLOCK_64X128,  BLOCK_128X64,  BLOCK_128X128,
            // 4X16,       16X4,          8X32
            BLOCK_4X16,    BLOCK_16X4,    BLOCK_8X32,
            // 32X8,       16X64,         64X16
            BLOCK_32X8,    BLOCK_16X64,   BLOCK_64X16,
            // 32x128,     128x32
            BLOCK_32X128,  BLOCK_128X32
        }, {  // PARTITION_HORZ
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X4,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X8,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X16,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X32,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_128X64,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_VERT
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_4X8,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X16,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X32,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X64,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X128,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_SPLIT
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_4X4,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X8,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X16,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X32,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X64,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_HORZ_A
            //                            4X4
                                            BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X4,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X8,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X16,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X32,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_128X64,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_HORZ_B
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X4,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X8,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X16,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X32,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_128X64,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_VERT_A
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_4X8,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X16,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X32,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X64,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X128,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_VERT_B
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_4X8,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X16,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X32,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X64,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X128,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_HORZ_4
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X4,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X8,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_64X16,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_128X32,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }, {  // PARTITION_VERT_4
            //                            4X4
                                          BLOCK_INVALID,
            // 4X8,        8X4,           8X8
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 8X16,       16X8,          16X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_4X16,
            // 16X32,      32X16,         32X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_8X32,
            // 32X64,      64X32,         64X64
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_16X64,
            // 64x128,     128x64,        128x128
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_32X128,
            // 4X16,       16X4,          8X32
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32X8,       16X64,         64X16
            BLOCK_INVALID, BLOCK_INVALID, BLOCK_INVALID,
            // 32x128,     128x32
            BLOCK_INVALID, BLOCK_INVALID
        }
    };

    const int32_t intra_mode_context[AV1_INTRA_MODES] = {
        0, 1, 2, 3, 4, 4, 4, 4, 3, 0, 1, 2, 0,
    };

    // The ctx offset table when TX is TX_CLASS_2D.
    // TX col and row indices are clamped to 4.
    const int8_t av1_nz_map_ctx_offset[TX_SIZES_ALL][5][5] = {
      // TX_4X4
      { { 0, 1, 6, 6, 0 },
        { 1, 6, 6, 21, 0 },
        { 6, 6, 21, 21, 0 },
        { 6, 21, 21, 21, 0 },
        { 0, 0, 0, 0, 0 } },
      // TX_8X8
      { { 0, 1, 6, 6, 21 },
        { 1, 6, 6, 21, 21 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_16X16
      { { 0, 1, 6, 6, 21 },
        { 1, 6, 6, 21, 21 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_32X32
      { { 0, 1, 6, 6, 21 },
        { 1, 6, 6, 21, 21 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_64X64
      { { 0, 1, 6, 6, 21 },
        { 1, 6, 6, 21, 21 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_4X8
      { { 0, 11, 11, 11, 0 },
        { 11, 11, 11, 11, 0 },
        { 6, 6, 21, 21, 0 },
        { 6, 21, 21, 21, 0 },
        { 21, 21, 21, 21, 0 } },
      // TX_8X4
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 0, 0, 0, 0, 0 } },
      // TX_8X16
      { { 0, 11, 11, 11, 11 },
        { 11, 11, 11, 11, 11 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_16X8
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 } },
      // TX_16X32
      { { 0, 11, 11, 11, 11 },
        { 11, 11, 11, 11, 11 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_32X16
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 } },
      // TX_32X64
      { { 0, 11, 11, 11, 11 },
        { 11, 11, 11, 11, 11 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_64X32
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 } },
      // TX_4X16
      { { 0, 11, 11, 11, 0 },
        { 11, 11, 11, 11, 0 },
        { 6, 6, 21, 21, 0 },
        { 6, 21, 21, 21, 0 },
        { 21, 21, 21, 21, 0 } },
      // TX_16X4
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 0, 0, 0, 0, 0 } },
      // TX_8X32
      { { 0, 11, 11, 11, 11 },
        { 11, 11, 11, 11, 11 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_32X8
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 } },
      // TX_16X64
      { { 0, 11, 11, 11, 11 },
        { 11, 11, 11, 11, 11 },
        { 6, 6, 21, 21, 21 },
        { 6, 21, 21, 21, 21 },
        { 21, 21, 21, 21, 21 } },
      // TX_64X16
      { { 0, 16, 6, 6, 21 },
        { 16, 16, 6, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 },
        { 16, 16, 21, 21, 21 } }
    };
} // namespace

#endif // MFX_ENABLE_AV1_VIDEO_ENCODE