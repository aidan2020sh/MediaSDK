####################################################################################
#
# INTEL CORPORATION PROPRIETARY INFORMATION
# This software is supplied under the terms of a license agreement or nondisclosure
# agreement with Intel Corporation and may not be copied or disclosed except in
# accordance with the terms of that agreement
# Copyright(c) 2010-2011 Intel Corporation. All Rights Reserved.
#
####################################################################################

# Importing MFX utilities modules
import mfx_utils

# Importing variables
Import('mfx_lib_env')
Import('mfx_bld_root')


# Creating build environment
bld_env = mfx_lib_env.Clone()
bld_env['MFX_CURDIR'] = '#_studio/shared/umc/test_suite/spy_test_component'

# Setting list of additional include directories
includes = [
             '#_studio/shared/umc/codec/color_space_converter/include',
             '#_studio/shared/umc/codec/h264_dec/include',
             '#_studio/shared/umc/test_suite/spy_test_component/Xerces/include'
            ]
bld_env.Append(CPPPATH = includes)

# Setting list of additional libraries to link with
libs = ['umc_codecs_merged', 'umc_codecs_merged_sw', 
        'umc_io_merged_sw',
        'umc_core_merged',
        'xerces-c'
]

libs_path = ['_studio/shared/umc/core',
             '_studio/shared/umc/codec',
             '_studio/shared/umc/io',
             '_studio/shared/umc/test_suite/spy_test_component/Xerces/lib'
]

bld_env.Append(LIBS = mfx_utils.prepare_libs(bld_env, libs))
bld_env.Append(LIBPATH = mfx_utils.attach_prefix(mfx_bld_root, libs_path))


# Setting additional IPP libraries to link with
libs_ipp = Split('ippvc_l ippi_l ippdc_l ippcc_l ipps_l ippcore_l')
bld_env.Append(LIBS = libs_ipp)

#Flags
flags = Split('-D XERCES_XML')
bld_env.Append(CCFLAGS = flags)

# Setting lists of sources
local = mfx_utils.get_filenames(Glob('src/*.cpp'))

# Preparing sources for compilation
sources = mfx_utils.prepare_sources(bld_env, local)

# Building application
library = bld_env.SharedLibrary(target = mfx_utils.get_build_name(bld_env, 'outline'), source = sources)

# Installing application
mfx_utils.install_if_exists(bld_env, library)